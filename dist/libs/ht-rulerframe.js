!function(k,Q){"use strict";var h="position",V="absolute",w="relative",p="px",z="left",W="right",E="top",M="bottom",d="display",_="none",e="block",m=ht.Default,v=m.getInternal(),F=Math.floor,O=Math.ceil,o=Math.PI,J=null,R=k.parseInt,H=function(f){return f.getContext("2d")},Y=function(){return document},x=function(E){return Y().createElement(E)},f=function(){return x("canvas")},N=function(S,u,C){S.style.setProperty(u,C,J)},q=function(Q,M,t){m.def(ht.widget[Q],M,t)},B=function(t,k){t.appendChild(k)},T=function(L,X){L.removeChild(X)},C=m.eventListenerOptionsFalse,A=(m.eventListenerOptionsTrue,function(e,s,J,G){e.addEventListener(s,J,G?C:C)}),u=function(Y,e,H,l){Y.removeEventListener(e,H,l?C:C)};ht.widget.RulerFrame=function(q){var O=this,D=O._view=v.createView(null,O),u=O.$1k=f(),R=O.$2k=f(),L=O.$3k=f(),o=O.$4k=f();O._defaultRulerConfig={size:20,borderWidth:1,borderStyle:"solid",borderColor:"#888",defaultMajorTickSpacing:50,minMajorTickSpacing:10,minPhysicalMajorTickSpacing:40,maxPhysicalMajorTickSpacing:100,tickSpacingAdaptable:!0,majorTickTextFont:"12px Arial",majorTickTextColor:"#666",majorTickColor:"#888",minorTickColor:"#ccc",background:"rgba(0,0,0,0)",guideColor:"rgb(0, 173, 239)",guideWidth:2,guideVisible:!1,guideTipVisible:!1,guideTipBorderColor:"#666",guideTipTextColor:"#666",guideTipTextFont:"12px Arial",guideTipBackground:"#fff"},O._topRulerConfig={visible:!0},O._rightRulerConfig={visible:!1},O._bottomRulerConfig={visible:!1},O._leftRulerConfig={visible:!0},B(D,u),B(D,L),B(D,R),B(D,o),N(D,h,w),N(D,"box-sizing","border-box"),N(D,"-moz-box-sizing","border-box"),N(u,h,V),N(R,h,V),N(L,h,V),N(o,h,V),O.$14k=function(){O.$13k=1,O.iv()},O.$15k=function(g){if(O._topRulerConfig.guideVisible||O._rightRulerConfig.guideVisible||O._bottomRulerConfig.guideVisible||O._leftRulerConfig.guideVisible||O._defaultRulerConfig.guideVisible||(O._topRulerConfig.guideTipVisible||O._rightRulerConfig.guideTipVisible||O._bottomRulerConfig.guideTipVisible||O._leftRulerConfig.guideTipVisible||O._defaultRulerConfig.guideTipVisible)&&O._component){var v=D.getBoundingClientRect();O.$16k={x:g.clientX-v.left,y:g.clientY-v.top},O.$5k()}},O.setComponent(q)},q("RulerFrame",Q,{ms_v:1,ms_fire:1,ms_ac:["defaultRulerConfig","topRulerConfig","rightRulerConfig","bottomRulerConfig","leftRulerConfig","component"],setComponent:function(U){var O=this,t=O._component,n=O.getView();if(n){if(O._component=U,O.fp("component",t,U),t){var Q=O.getComponentView(t);T(n,Q),u(n,"mousemove",O.$15k),O.removeComponentPropertyChangeListener(t,O.$14k)}if(U){var P=O.getComponentView(U);B(n,P),N(P,h,V),A(n,"mousemove",O.$15k),O.addComponentPropertyChangeListener(U,O.$14k)}}},addComponentPropertyChangeListener:function(A,a){A&&A.mp&&A.mp(a)},removeComponentPropertyChangeListener:function(s,K){s&&s.ump&&s.ump(K)},getComponentHZoom:function(X){return X&&X.getZoom?X.getZoom():1},getComponentVZoom:function(g){return g&&g.getZoom?g.getZoom():1},getComponentViewRect:function(M){return M&&M.getViewRect?M.getViewRect():void 0},getComponentView:function(p){return p&&p.getView?p.getView():p},invalidateComponent:function(R){R&&R.iv&&R.iv()},validateComponent:function(K){K&&K.validate&&K.validate()},$7k:function(X,f,I,F,U,p,g,K,M,V,n,h){if(f.visible){var H=this._defaultRulerConfig,T="borderStyle",y="borderColor",L="borderWidth",w="background",R=f[T]||H[T],$=f[y]||H[y],l=f[L]||H[L],m=f.size!=J?f.size:H.size,j=f[w]||H[w],u=m+l,C=this.$6k(l,R,$,X,I,U,u,g,K,M,V,n,h);N(X,U,"0px"),p?v.setCanvas(X,F-C,m):v.setCanvas(X,m,F-C),N(X,"background",j),N(X,d,e)}else N(X,d,_),N(this.getComponentView(this._component),U,"0px")},$6k:function(H,V,A,m,$,Z,G,B,h,r,W,O,n){var K=0;return N(m,$,H+"px "+V+" "+A),N(this.getComponentView(this._component),Z,G+p),B?(N(m,h,r+p),K+=r):N(m,h,"0px"),W?(N(m,O,n+p),K+=n):N(m,O,"0px"),K},validateImpl:function(){var K=this,y=K._component,N=K.$1k,t=K.$2k,e=K.$3k,H=K.$4k,R=K._view,V=K._defaultRulerConfig,j=K._topRulerConfig,o=K._rightRulerConfig,l=K._bottomRulerConfig,q=K._leftRulerConfig,b=V.size;if(R&&y){var A=j.size!=J?j.size:b,D=o.size!=J?o.size:b,w=l.size!=J?l.size:b,$=q.size!=J?q.size:b;K.$7k(N,j,"border-bottom",R.offsetWidth,E,!0,q.visible,z,$,o.visible,W,D),K.$7k(t,o,"border-left",R.offsetHeight,W,!1,j.visible,E,A,l.visible,M,w),K.$7k(e,l,"border-top",R.offsetWidth,M,!0,q.visible,z,$,o.visible,W,D),K.$7k(H,q,"border-right",R.offsetHeight,z,!1,j.visible,E,A,l.visible,M,w),K.$13k?delete K.$13k:K.invalidateComponent(y),K.validateComponent(y),K.$5k()}},$5k:function(){function Z(M,V,Z,k,$,g){if(V.visible){var r=H(M),W=V[F]||u,X=V[t]!=J?V[t]:v,s=V[y]||L,D=V[b]||A,R=V.size!=J?V.size:e,is=V[G]||T,ln=V[i]||p,uq=V[a]||f,cf=V[h]!=J?V[h]:_,Id=V[K]!=J?V[K]:Q,Rg=V[j]!=J?V[j]:d,fr=V[o]!=J?V[o]:I,ar=V[E]!=J?V[E]:O,xl=V[n]!=J?V[n]:Y,hq=V[x]||xg,Nq=V[S]||Fm;X&&(W=B[g]=B.$8k(B[g]||W,V[z]||w,V[C]||U,k?N:m,ln)),Z.call(B,r,q,P,l,c,R,k?N:m,W,s,D,$,is,uq);var zp=B.$16k;(cf||Id)&&zp&&(k?B.$9k(r,zp.x,R,hq,Nq,cf,Id,Rg,fr,ar,xl):B.$10k(r,zp.y,R,hq,Nq,cf,Id,Rg,fr,ar,xl,$))}}var B=this,X=B.$1k,$=B.$2k,V=B.$3k,k=B.$4k,r=B._topRulerConfig,M=B._rightRulerConfig,g=B._bottomRulerConfig,W=B._leftRulerConfig,D=B._defaultRulerConfig,R=B._component,s=B.getComponentViewRect(R),N=B.getComponentHZoom(R),m=B.getComponentVZoom(R),q=s.x*N,l=q+s.width*N,P=s.y*m,c=P+s.height*m,e=B._defaultRulerConfig.size,F="defaultMajorTickSpacing",z="maxPhysicalMajorTickSpacing",C="minPhysicalMajorTickSpacing",t="tickSpacingAdaptable",y="majorTickTextFont",b="majorTickTextColor",G="majorTickColor",a="minorTickColor",h="guideVisible",K="guideTipVisible",j="guideTipBorderColor",o="guideTipTextColor",E="guideTipTextFont",n="guideTipBackground",x="guideColor",S="guideWidth",i="minMajorTickSpacing",u=D[F],w=D[z],U=D[C],v=D[t],L=D[y],A=D[b],T=D[G],p=D[i],f=D[a],_=D[h],Q=D[K],d=D[j],I=D[o],O=D[E],Y=D[n],xg=D[x],Fm=D[S];B._view&&R&&(Z(X,r,B.$11k,!0,!1,"_currentTopMajorTickSpacing"),Z($,M,B.$12k,!1,!0,"_currentRightMajorTickSpacing"),Z(V,g,B.$11k,!0,!0,"_currentBottomMajorTickSpacing"),Z(k,W,B.$12k,!1,!1,"_currenLeftMajorTickSpacing"))},$8k:function(B,k,G,t,y){return G>B*t?B=F(k/t/y)*y:B*t>k&&(B=O(G/t/y)*y),B},getHTipText:function(H){var F=this,g=F._component,N=0,n=F._view.getBoundingClientRect();return g.lp?N=R(g.lp({x:H.x+n.left,y:H.y}).x):N-=R(this.getComponentView(g).style.left)||0,N},$9k:function(r,I,l,g,k,U,Z,$,O,P,D){var C=this,X=C._component;r.save(),v.translateAndScale(r,0,0,1);var s=I-(R(this.getComponentView(X).style.left)||0),M=0;if(I=C.getHTipText(C.$16k),U&&(r.beginPath(),r.fillStyle=g,r.rect(s,M,k,l),r.fill()),Z){r.beginPath(),r.textAlign="center",r.textBaseline="middle",r.font=P;var p=r.measureText(I).width+6;r.fillStyle=D,r.rect(s-p/2,M,p,l),r.fill(),r.strokeStyle=$,r.stroke(),r.beginPath(),r.fillStyle=O,r.fillText(I,s,M+l/2)}r.restore()},getVTipText:function(n){var b=this,k=b._component,K=0,h=b._view.getBoundingClientRect();return k.lp?K=R(k.lp({x:n.x,y:n.y+h.top}).y):K-=R(this.getComponentView(k).style.top)||0,K},formatScaleText:function(N){return Math.round(N)},$10k:function(f,z,t,u,i,Q,y,$,H,a,K,T){var j=this,C=j._component;f.save(),v.translateAndScale(f,0,0,1);var c=t/2,P=z-(R(this.getComponentView(C).style.top)||0);if(z=j.getVTipText(j.$16k),Q&&(f.beginPath(),f.fillStyle=u,f.rect(c-t/2,P,t,i),f.fill()),y){f.translate(c,P),f.rotate((T?90:-90)*o/180),f.translate(-c,-P),f.beginPath(),f.textAlign="center",f.textBaseline="middle",f.font=a;var e=f.measureText(z).width+6;f.fillStyle=K,f.rect(c-e/2,P-t/2,e,t),f.fill(),f.strokeStyle=$,f.stroke(),f.fillStyle=H,f.fillText(z,c,P)}f.restore()},$11k:function(G,k,f,$,l,T,d,Y,z,J,C,i,u){G.save(),f=0;var x=k,w=$,Z=(x+w)/2;k=0,$=w-x,v.translateAndScale(G,0,0,1);var D=0,S=0,p=R(T/2),B=T-p,L=C?0:p,e=Y*d,U=e/10;k-=e,$+=e,G.clearRect(k,0,$-k,T),G.beginPath(),G.fillStyle=u;var m=F(Z/U)*U-x;for(D=m;$>D;D+=U)G.rect(D,f+L,1,B);for(D=m;D>k;D-=U)G.rect(D,f+L,1,B);for(G.fill(),L=C?0:1,G.beginPath(),G.fillStyle=i,m=F(Z/e)*e-x,D=m;$>D;D+=e)G.rect(D,f+L,1,T-1);for(D=m;D>k;D-=e)G.rect(D,f+L,1,T-1);G.fill();var o=R(/\d+px/.exec(z)[0]),t=(o||10)/2;G.textBaseline="middle",L=C?T-t-2:t+2,G.beginPath(),G.fillStyle=J,G.font=z;var c=F(Z/e)*e/d;for(D=m,S=c;$>D;D+=e,S+=Y){var g=this.getHScaleText?this.getHScaleText(D):S;G.fillText(this.formatScaleText(g),D+2,f+L)}for(D=m,S=c;D>k;D-=e,S-=Y){var g=this.getHScaleText?this.getHScaleText(D):S;G.fillText(this.formatScaleText(g),D+2,f+L)}G.restore()},$12k:function(B,C,E,G,U,c,b,k,w,d,t,m,l){function Y(y,Z,e,u,z,w){z=i.getVScaleText?i.getVScaleText(e):z,z=i.formatScaleText(z),B.translate(y+Z,e),B.rotate(-u),B.translate(-y-Z,-e),B.fillText(z,y+Z+(w?2:1),e),B.translate(y+Z,e),B.rotate(u),B.translate(-y-Z,-e)}B.save(),C=0;var P=E,S=U,A=(P+S)/2;E=0,U=S-P,v.translateAndScale(B,0,0,1);var X=0,i=this,s=0,I=R(c/2),N=c-I,J=t?0:I,n=k*b,j=n/10;E-=n,U+=n,B.clearRect(C,0,c,U-E),B.beginPath(),B.fillStyle=l;var T=F(A/j)*j-P;for(X=T;U>X;X+=j)B.rect(C+J,X,N,1);for(X=T;X>E;X-=j)B.rect(C+J,X,N,1);for(B.fill(),J=t?0:1,B.beginPath(),B.fillStyle=m,T=F(A/n)*n-P,X=T;U>X;X+=n)B.rect(C+J,X,c-1,1);for(X=T;X>E;X-=n)B.rect(C+J,X,c-1,1);B.fill();var K=R(/\d+px/.exec(w)[0]),a=(K||10)/2,Z=90*o/180;B.textBaseline="middle",J=t?c-a:a+2,Z=t?-Z:Z,B.beginPath(),B.fillStyle=d,B.font=w;var f=F(A/n)*n/b;for(X=T,s=f;U>X;X+=n,s+=k)Y(C,J,X,Z,s,t);for(X=T,s=f;X>E;X-=n,s-=k)Y(C,J,X,Z,s,t);B.restore()},onPropertyChanged:function(){this.iv()},dispose:function(){var M=this,$=M._component,U=M._view;$&&M.removeComponentPropertyChangeListener($,M.$14k),U&&(u(U,"mousemove",M.$15k),T(U.parentNode,U),M._view=null)}})}("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:(0,eval)("this"),Object);