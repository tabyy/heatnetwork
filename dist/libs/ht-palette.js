!function(Y,j,t){"use strict";var Z="px",Q="0",F="innerHTML",J="className",l=ht.Default,u=ht.Color,f=ht.Node,E="position",S="top",P="left",b=l.animate,e=l.getInternal(),X="width",Q="0",c="none",D="max-height",q="font",W="background",z="border-box",s="user-select",G="box-sizing",w="overflow",R=l.isTouchable,e=l.getInternal(),p=u.titleIconBackground,g=l.scrollBarInteractiveSize,V=/msie 9/.test(Y.navigator?Y.navigator.userAgent.toLowerCase():""),n=null,x=function(){return document},M=function(O){return x().createElement(O)},r=function(){return M("div")},O=function(){var I=r(),l=I.style;return l.msTouchAction=c,l.cursor="default",R&&l.setProperty("-webkit-tap-highlight-color","rgba(0, 0, 0, 0)",n),l.position="absolute",l.left=Q,l.top=Q,I},_=function(){return M("canvas")},i=function(){return document.body},U=function(y,Z,g){y.style.setProperty(Z,g,n)},d=function(b,l){b.style.removeProperty(l)},C=function(I,L,z){l.def(ht.widget[I],L,z)},h=function(b,n){b.appendChild(n)},o=function(v,p){v.removeChild(p)},v=l.eventListenerOptionsFalse,A=(l.eventListenerOptionsTrue,function(M,r,o,D){M.addEventListener(r,o,D?v:v)});e.addMethod(l,{paletteExpandIcon:{width:16,height:16,comps:[{type:"triangle",rect:[4,4,10,8],background:p,rotation:3.14}]},paletteCollapseIcon:{width:16,height:16,comps:[{type:"triangle",rect:[4,4,10,8],background:p}]},paletteTitleLabelColor:l.labelSelectColor,paletteTitleLabelFont:l.labelFont,paletteContentLabelFont:l.labelFont,paletteContentLabelColor:"#777",paletteContentBackground:"#fff",paletteTitleHeight:l.widgetTitleHeight,paletteTitleBackground:u.titleBackground,paletteTitleHoverBackground:u.titleBackground,paletteSeparatorWidth:1,paletteSeparatorColor:t,paletteItemHoverBorderColor:u.highlight,paletteItemSelectBackground:u.highlight},!0);var y=".palette-item:hover{border: 1px solid "+l.paletteItemHoverBorderColor+" !important}"+" .palette-header:hover{background: "+l.paletteTitleHoverBackground+" !important}",m=document.createElement("style");R||(m.styleSheet?m.styleSheet.cssText=y:m.appendChild(x().createTextNode(y))),x().getElementsByTagName("head")[0].appendChild(m);var I=function(P){var N=this;N.$22h=P,N.addListeners()};l.def(I,j,{ms_listener:1,getView:function(){return this.$22h.getView()},$26h:function(){var $=this;$.$36h&&i().removeChild($.$36h),$.$23h=$.$24h=$.$25h=$.$35h=$.$36h=n},handle_touchstart:function(L){for(var v,e=this,W=e.$22h,R=L.target,T=W.sm(),V=W.dm(),i="palette-header",j="palette-header-tool",K="palette-item",w=!1,u=!1,I=!1;R&&(R[J]||"").indexOf(i)<0&&(R[J]||"").indexOf(K)<0;)R=R.parentNode;if(R&&R[J].indexOf(j)>=0?w=!0:R&&R[J].indexOf(i)>=0?I=!0:R&&R[J].indexOf(K)>=0&&(u=!0),l.isLeftButton(L))if(e.$27h(L))e.$24h=l.getClientPoint(L),e.$25h=W.ty();else if(w){l.preventDefault(L),v=R.parentNode.$11h;var $=V.getDataById(v),Y=$.s("tools")[R.toolIndex];Y.action&&Y.action.call(W)}else if(I){l.preventDefault(L),v=R.$11h;var $=V.getDataById(v);$.isExpanded()?$.setExpanded(!1):$.setExpanded(!0)}else if(u){v=R.$11h;var x=V.getDataById(v);T.ss(x),W.handleDragAndDrop&&(l.preventDefault(L),x.s("draggable")&&(W.handleDragAndDrop(L,"prepare"),e.$35h=0)),x.s("draggable")||(l.preventDefault(L),e.$24h=l.getClientPoint(L),e.$25h=W.ty())}else l.preventDefault(L),e.$24h=l.getClientPoint(L),e.$25h=W.ty();else e.$26h(L)},handle_mousedown:function(y){this.handle_touchstart(y)},handle_mousewheel:function(D){this.handleScroll(D,D.wheelDelta/40,D.wheelDelta!==D.wheelDeltaX)},handle_DOMMouseScroll:function(r){this.handleScroll(r,-r.detail,1)},handleScroll:function(x,Q,A){var I=this.$22h;l.preventDefault(x),A&&I._41o()&&I.ty(I.ty()+20*Q)},handle_mouseup:function(t){this.handle_touchend(t)},handle_touchend:function(X){var H=this;H.$37h(X),H.$26h(X)},handleWindowMouseUp:function(k){this.handleWindowTouchEnd(k)},handleWindowTouchEnd:function(t){var $=this;$.$37h(t),$.$26h(t)},$37h:function(w){var N=this,o=N.$22h;2===N.$35h&&(N.$35h=3,o.handleDragAndDrop(w,"end"))},handleWindowMouseMove:function(T){this.handleWindowTouchMove(T)},handleWindowTouchMove:function(N){var $=this,T=$.$22h,i=$.$23h,W=$.$24h,G=$.$25h,o=l.getClientPoint(N),m=T._29I,V=$.$36h;if(1===$.$35h||2===$.$35h){if($.$35h=2,T.handleDragAndDrop(N,"between"),R){var _=N.touches[0];N=_?_:N.changedTouches[0]}V.style.left=N.pageX-parseInt(V.width)/2+Z,V.style.top=N.pageY-parseInt(V.height)/2+Z}else"p"===i?T.ty(G+o.y-W.y):"v"===i&&T.ty(G+(W.y-o.y)/m.height*T._59I)},handle_mousemove:function(K){this.handle_touchmove(K)},handle_touchmove:function(j){if(!l.isDragging()&&l.isLeftButton(j)){var Q=this,G=Q.$22h,O=Q.$27h(j);if(Q.$24h){if(!Q.$23h){if(l.getDistance(l.getClientPoint(j),Q.$24h)<2)return;Q.$23h=O?"v":"p",l.startDragging(Q)}}else if(O)G._43o();else if(0===Q.$35h){if(Q.$35h=1,G.handleDragAndDrop(j,"begin"),R){var I=j.touches[0];j=I?I:j.changedTouches[0]}var _=Q.$36h=new Image,y=G.$10h[G.sm().ld().getId()].querySelector(".image-box"),o=parseInt(y.style.width),u=parseInt(y.style.height);_.draggable=!1,_.src=y.toDataURL(),_.width=o,_.height=u,_.style.position="absolute",_.style.left=j.pageX-o/2+Z,_.style.top=j.pageY-u/2+Z,i().appendChild(_),l.startDragging(Q)}}},$27h:function(P){var k=this.$22h,H=k.getView(),z=H.getBoundingClientRect(),M=k._29I,J=P.clientX-z.left+H.scrollLeft;return k._41o()&&M.x+M.width-J<g}}),ht.widget.Palette=function(u){var _=this,V=_._view=e.createView(null,_);_.$9h={},_.$10h={},_.$4h={},_._29I={x:0,y:0,width:0,height:0},_._59I=0,_.dm(u?u:new ht.DataModel),V[J]="ht-widget-palette",_.$29h=new I(_),U(V,W,l.paletteContentBackground),U(V,w,"auto"),U(V,G,z),U(V,"-moz-"+G,z),U(V,"-webkit-"+s,c),U(V,"-moz-"+s,c),U(V,"-ms-"+s,c),U(V,s,c),U(V,"position","absolute"),U(V,"overflow","hidden"),h(V,_._79O=O()),A(V,"dragstart",function(R){R.dataTransfer&&(R.dataTransfer.setData("Text","nodeid:"+R.target.$11h),R.dataTransfer.effectAllowed="all",_.$29h.$26h())})},C("Palette",j,{ms_v:1,ms_fire:1,ms_dm:1,ms_sm:1,ms_vs:1,ms_ac:["itemImageWidth","itemImageHeight","itemImagePadding","itemMargin","layout","autoHideScrollBar","scrollBarSize","scrollBarColor"],$30h:0,_itemImagePadding:4,_itemImageWidth:70,_itemImageHeight:50,_itemMargin:10,_layout:"largeicons",_autoHideScrollBar:l.autoHideScrollBar,_scrollBarSize:l.scrollBarSize,_scrollBarColor:l.scrollBarColor,getViewRect:function(){return this._29I},ty:function($){return $==n?this.getTranslateY():(this.setTranslateY($),void 0)},setTranslateY:function(Z){if(this.$32h==n){var h=this,j=h.$33h(Z),W=h.$30h;h.$30h=j,h.fp("translateY",W,j)}},getTranslateY:function(){return this.$30h},setLayout:function(G){var g,P,Q=this,_=Q._layout;Q._layout=G,"smallicons"===G?g=P=20:"iconsonly"===G?g=P=50:(g=70,P=50),Q.setItemImageWidth(g),Q.setItemImageHeight(P),Q.setItemImagePadding(4),Q.fp("layout",_,G)},getDataAt:function(v){for(var k=v.target;k&&k.$11h==n;)k=k.parentNode;return k&&k.$11h!=n?this.getDataModel().getDataById(k.$11h):void 0},$20h:function(){var r=16;return R&&(r*=1.2),r},$19h:function(){return l.paletteTitleHeight},$18h:function(){var $=l.paletteSeparatorWidth,z=l.paletteTitleBackground,K=l.paletteSeparatorColor||l.brighter(z);return $+Z+" solid "+K},$17h:function(y){U(y,"cursor","pointer"),U(y,"display","inline-block"),U(y,"margin-right",(R?8:4)+Z),U(y,"vertical-align",S)},$1h:function(b){var A=this,y=r(),j=r(),Y=M("span");y[J]="palette-header",U(y,E,"relative"),U(y,W,l.paletteTitleBackground),U(y,"color",l.paletteTitleLabelColor),U(y,S,Q),U(y,G,z),U(y,"-moz-"+G,z),U(y,"padding","0 5px 0 0"),U(y,"border-top",A.$18h()),U(y,X,"100%"),U(y,"cursor","pointer"),U(y,"white-space","nowrap"),U(y,w,"hidden"),U(y,q,l.paletteTitleLabelFont),U(y,"line-height",A.$19h()+Z),y.$11h=b.getId();var N=_(),p=A.$19h(),m=A.$20h();A.$17h(N),e.setCanvas(N,m,p),h(y,N);var t=b.s("tools");if(t)for(var O=0;O<t.length;O++){var k=_();A.$17h(k),e.setCanvas(k,m,p),k[J]="palette-header-tool palette-header-tool"+b.getId()+"-"+O,k.style.position="absolute",k.style.right=(m+10)*O+"px",k.toolIndex=O,h(y,k)}return N[J]="palette-toggle-icon-"+b.getId(),j[J]="palette-content",U(j,"max-height",0+Z),U(j,q,l.paletteContentLabelFont),U(j,w,"hidden"),j.$11h=b.getId(),A.$9h[b.getId()]=j,Y[F]=b.getName(),U(Y,q,l.paletteTitleLabelFont),h(y,N),h(y,Y),[y,j]},$2h:function(L){var Y=this,n=Y._layout,q=V&&L.s("draggable")?M("a"):r(),A=_(),T=r(),C=L.getName()||"",b=L.s("title")||L.getToolTip()||C,m=Y._itemMargin;A[J]="image-box";var u=Y.getItemImageWidth(),H=Y.getItemImageHeight();return e.setCanvas(A,u,H),h(q,A),T[F]=C,T[J]="label-box","iconsonly"!==n&&h(q,T),q[J]="palette-item",U(q,"vertical-align",S),U(q,"cursor","pointer"),U(q,"border-radius",5+Z),U(q,"border","1px solid transparent"),U(q,"text-align","center"),U(q,"display","inline-block"),U(q,"margin-left",m+Z),U(q,"margin-top",m+Z),U(q,"color",l.paletteContentLabelColor),"smallicons"===n?(U(A,"vertical-align","middle"),U(q,"margin-left",2+Z),U(q,"margin-top",2+Z),U(q,"padding",2+Z),U(q,"text-align",P),U(T,"display","inline-block"),U(T,"min-width",Y.$21h+Y._itemMargin+Z)):"largeicons"===n&&(U(T,"max-width",u+Z),U(T,"overflow","hidden")),q.$11h=L.getId(),b&&(q.title=b),L.s("draggable")&&!Y.handleDragAndDrop&&(V?(q.href="#",U(q,"text-decoration",c)):q.draggable="true"),q},$16h:function(K,q,Y,j){var o=e.initContext(K);e.translateAndScale(o,0,0,1),o.clearRect(0,0,Y,Y);var C=(Y-j)/2;l.drawStretchImage(o,l.getImage(q),"fill",0,C,j,j),o.restore()},$15h:function(q){var U=this,e=q.getId(),u=U._view.querySelector(".palette-toggle-icon-"+e),C=q.isExpanded()?l.paletteCollapseIcon:l.paletteExpandIcon;if(u&&C){var W=U.$19h(),$=U.$20h();U.$16h(u,C,W,$)}},_drawToolsIcon:function(D){var l=this,$=D.s("tools");if($)for(var C=0;C<$.length;C++){var A=l._view.querySelector(".palette-header-tool"+D.getId()+"-"+C),c=$[C].icon,r=l.$19h(),o=l.$20h();l.$16h(A,c,r,o)}},$14h:function(w){var d=this,s=w.getId(),D=d.$10h[s].querySelector(".image-box"),p=w.getImage(),k=w.s("image.stretch");if(D&&p){var c=e.initContext(D),U=d.getItemImagePadding();U="smallicons"===d._layout?U/2:U;var f=d.getItemImageWidth()-2*U,o=d.getItemImageHeight()-2*U;e.translateAndScale(c,0,0,1),c.clearRect(0,0,f,o),l.drawStretchImage(c,l.getImage(p),k,U,U,f,o,w,d),c.restore()}},validateImpl:function(){var I,c,j,H=this,s=H.$9h,T=H._layout,C=H.$10h,B=H.$4h,R=H._view,V=H.dm();if(H.$13h&&(delete H.$13h,B={},V.each(function(Z){B[Z.getId()]=Z})),"smallicons"===T)for(var w in B){var X=B[w];if(X instanceof f){var k=X.getName()||"",g=l.getTextSize(l.paletteContentLabelFont,k).width;H.$21h!=n&&H.$21h>g||(H.$21h=g)}}for(var w in B){j=B[w];var d,i;if(V.contains(j)){if(j instanceof ht.Group){var m,r=H.$1h(j),U=C[j.getId()];U&&(m=U.nextSibling,o(R,m),o(R,U)),c=V.getSiblings(j).indexOf(j);var q=R.children[2*c]||H._79O;q&&q.parentNode?(R.insertBefore(r[0],q),R.insertBefore(m||r[1],q)):(R.appendChild(r[0]),R.appendChild(m||r[1])),C[j.getId()]=r[0],I=s[j.getId()]=m||r[1],i=j.$12h;var v=j.s("promptText");i||(j.$12h=M("div"),j.$12h[F]=v||"",i=j.$12h),0===j.getChildren().size()?I.contains(i)||h(I,i):I.contains(i)&&o(I,i)}else if(d=j.getParent()){var K=H.$2h(j),$=C[j.getId()];I=s[d.getId()],$&&o($.parentNode,$),c=V.getSiblings(j).indexOf(j);var u=I.children[c];u?I.insertBefore(K,u):h(I,K),C[j.getId()]=K,H.$14h(j)}}else{var t=C[j.getId()],a=t.parentNode;if(j instanceof ht.Group){var e=t.nextSibling;o(R,t),o(R,e),delete s[j.getId()]}else o(a,t),0===a.children.length&&(d=V.getDataById(a.$11h),d&&(i=d.$12h,i&&!a.contains(i)&&h(a,i)));delete C[j.getId()]}}H.$4h={};var N=function(){var S=H._59I,E=0;H.$32h!=n&&(clearInterval(H.$32h),E=0,delete H.$32h),H.$32h=setInterval(function(){H.$31h(),S===H._59I?(E++,E>=2&&(clearInterval(H.$32h),delete H.$32h)):(E=0,S=H._59I)},30)};for(var P in s)if(I=s[P],j=V.getDataById(s[P].$11h),H.$15h(j),H._drawToolsIcon(j),j.isExpanded()){if(I.style.maxHeight===0+Z){var S=I.scrollHeight+H._itemMargin+Z;b(I).duration(200).set(D,S).set("padding-bottom",H._itemMargin+Z).end(function(){return function(){N()}}(S))}else I.style.maxHeight=I.scrollHeight+Z;I.style.paddingBottom=H._itemMargin+Z}else I.style.maxHeight!==0+Z&&b(I).duration(200).set(D,Q).set("padding-bottom",Q).end(function(){return function(){N()}}(I));H.$28h(),H.$31h()},$31h:function(){for(var X=this,j=X._view,w=0,r=j.children,x=0;x<r.length;x++){var f=r[x];f.className&&f.className.indexOf("palette-")>=0&&(w+=f.offsetHeight)}X._59I=w,X.$30h=X.$33h(X.ty());var e=X.ty();j.scrollTop=-e,X._29I={x:0,y:-e,width:j.clientWidth,height:j.clientHeight},U(X._79O,S,-e+Z),X._93I()},$33h:function(X){var K=this,p=K._29I.height-K._59I;return p>X&&(X=p),X>0?0:Math.round(X)},redraw:function(){this.$13h||(this.$13h=1,this.iv())},onPropertyChanged:function(v){["autoHideScrollBar","scrollBarSize","scrollBarColor","translateY"].indexOf(v.property)<0&&this.redraw(),"translateY"===v.property&&(this.iv(),this._43o())},findDataByName:function(S){for(var f=this.dm().getDatas(),g=0;g<f.size();g++){var F=f.get(g);if(F.getName()===S)return F}},setDataModel:function(C){var d=this,n=d._dataModel,O=d._selectionModel;n!==C&&(n&&(n.umm(d.$6h,d),n.umd(d.$8h,d),n.umh(d.$7h,d),O||n.sm().ums(d.$28h,d)),d._dataModel=C,C.mm(d.$6h,d),C.md(d.$8h,d),C.mh(d.$7h,d),O?O._21I(C):C.sm().ms(d.$28h,d),d.sm().setSelectionMode("single"),d.fp("dataModel",n,C))},$6h:function(P){var m=this,S=m._view,M=P.data,o=m.$4h;"add"===P.kind?o[M.getId()]=M:"remove"===P.kind?o[M.getId()]=M:"clear"===P.kind&&(m.$10h={},m.$9h={},m.$4h={},S[F]=""),m.iv()},$7h:function(y){var Z=this,I=y.data;Z.$4h[I.getId()]=I,Z.iv()},$8h:function(U){var g=this,f=U.data,I=U.property;"expanded"===I?g.iv():(g.$4h[f.getId()]=f,g.iv())},$28h:function(){var i,K=this,z=K.sm(),M="palette-item",x=z.ld();this.dm().each(function(p){i=K.$10h[p.getId()],i&&i[J].indexOf(M)>=0&&(p===x?U(i,W,l.paletteItemSelectBackground):d(i,W))})}})}("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:(0,eval)("this"),Object);