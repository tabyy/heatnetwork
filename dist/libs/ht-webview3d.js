!function(H){"use strict";function i(l){var q,X,b,$,p,r,w,M=[],u=0;q=K.createDiv(),q.style.overflow="hidden";var j=l.getView();j.insertBefore(q,l.getCanvas()),X=h.Default.createDiv(),X.style.WebkitTransformStyle="preserve-3d",X.style.MozTransformStyle="preserve-3d",X.style.transformStyle="preserve-3d",q.appendChild(X),[{event:"mousedown",style:"none"},{event:"mouseup",style:"auto"},{event:"touchstart",style:"none"},{event:"touchend",style:"auto"}].forEach(function(i){var D=i.style;j.addEventListener(i.event,function(){q.style.pointerEvents=D})}),this.updateWebView=function(){var z=l.getCanvas(),L=1*z.style.width.slice(0,-2),A=1*z.style.height.slice(0,-2);(M[0]!==L||M[1]!==A)&&(M[0]=L,M[1]=A,q.style.width=L+"px",q.style.height=A+"px",X.style.width=L+"px",X.style.height=A+"px");var v=l._projectMatrix[5]*M[1]/2;v!==b&&(b=v,q.style.WebkitPerspective=b+"px",q.style.MozPerspective=b+"px",q.style.perspective=b+"px"),r="translateZ("+b+"px)"+a(l._viewMatrix);var H=r+"translate("+M[0]/2+"px,"+M[1]/2+"px)";$===H||p||(X.style.WebkitTransform=H,X.style.MozTransform=H,X.style.transform=H,$=H),u++,w=!1,l.dm().each(function(C){C.isWebView&&m(C)});for(var B,F=X.children,d=[],N=0,g=F.length;g>N;N++)B=F[N],B._isHtWebView&&B._renderCookie!==u&&d.push(B);d.length&&d.forEach(function(Q){X.removeChild(Q)})};var o=new Array(16),m=function(P){var j=P.getAttach();if(j){j.parentElement!==X&&X.appendChild(j),j._renderCookie=u,w=!0;var e=P.getFinalScale3d(),t=P._prefrenceSize;t&&t[0]?t[1]||(t[1]=t[0]/e[0]*e[1]):t=[e[0],e[1]],j.style.width=t[0]+"px",j.style.height=t[1]+"px";var $=1/t[0],Z=1/t[1],s=1,F=P.mat;o[0]=F[0]*$,o[1]=F[1]*$,o[2]=F[2]*$,o[3]=F[3]*$,o[4]=F[4]*Z,o[5]=F[5]*Z,o[6]=F[6]*Z,o[7]=F[7]*Z,o[8]=F[8]*s,o[9]=F[9]*s,o[10]=F[10]*s,o[11]=F[11]*s,o[12]=F[12],o[13]=F[13],o[14]=F[14],o[15]=F[15];var Y=x(o,p?"translate("+M[0]/2+"px,"+M[1]/2+"px)"+r:""),z=j.$a2;z!==Y&&(j.$a2=Y,j.style.WebkitTransform=Y,j.style.MozTransform=Y,j.style.transform=Y)}}}function W(J){return Math.abs(J)<1e-10?0:J}function a(M){var T=M;return"matrix3d("+W(T[0])+","+W(-T[1])+","+W(T[2])+","+W(T[3])+","+W(T[4])+","+W(-T[5])+","+W(T[6])+","+W(T[7])+","+W(T[8])+","+W(-T[9])+","+W(T[10])+","+W(T[11])+","+W(T[12])+","+W(-T[13])+","+W(T[14])+","+W(T[15])+")"}function x(v,E){var m=v,e="matrix3d("+W(m[0])+","+W(m[1])+","+W(m[2])+","+W(m[3])+","+W(-m[4])+","+W(-m[5])+","+W(-m[6])+","+W(-m[7])+","+W(m[8])+","+W(m[9])+","+W(m[10])+","+W(m[11])+","+W(m[12])+","+W(m[13])+","+W(m[14])+","+W(m[15])+")";return"translate(-50%,-50%)"+(E||"")+e}var L="ht",h=H[L],K=h.Default,O=K.getInternal(),R=O.superCall,e=h.graph3d.Graph3dView,Q=e.prototype.validateImpl;e.prototype.validateImpl=function(){Q.call(this);var B=this._webViewRenderer;B||(B=this._webViewRenderer=new i(this)),B.updateWebView()};var q=h.WebView3d=function(){var k=this;R(q,k),k.s({shape3d:"billboard","shape3d.reverse.flip":!0})},o=[1,1,1,1],E=[0,0,0,0];K.def(L+"."+"WebView3d",h.Node,{ms_ac:["attach"],isWebView:!0,attachDOM:function(k,C,K){if(!k)return this.detachDOM();if("string"==typeof k){var T=document.createElement("iframe");T.src=k,k=T}var y=k.style;y.position="absolute",y.border=0,y.outline=0,y.padding=0,y.margin=0,k._isHtWebView=!0,this.setAttach(k),this._prefrenceSize=[C,K],this.s("shape3d.blend",E)},detachDOM:function(){this.setAttach(null),this.s("shape3d.blend",this.getBgColor())},setBgColor:function(s){this.a("defaultBgColor",s),this.getAttach()||this.s("shape3d.blend",s)},getBgColor:function(){return this.a("defaultBgColor")||o}})}("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:(0,eval)("this"),Object);