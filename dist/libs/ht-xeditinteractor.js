!function(I,w,k){"use strict";var s="ht",$=I[s],T=$.Default,_=$.graph,e=T.getInternal(),h=e.ui(),n=h.NodeUI.prototype,L=h.ShapeUI.prototype,K=_.GraphView,q=K.prototype,M=h.EdgeUI.prototype,H=$.Node,t=$.Shape,U=$.Edge,C=$.Group,E=T.isTouchable,d=T.preventDefault,g=I.setTimeout,z=T.grow,P=T.isDragging,y=T.getDistance,Z=null,l=$.List,O="undefined"!=typeof Float32Array?Float32Array:Array,i=Math,r=i.PI,x="Crossing",R="No Crossing",Q=r/2,Y=2*r,o=i.atan2,u=i.sqrt,S=i.pow,j=i.sin,a=i.cos,V=i.min,D=i.max,v=i.abs,J=i.ceil,W=i.round,m=T.unionPoint,c=T.unionRect,F=T.containsPoint,p=T.clone,X="rgb(52, 152, 219)",G="red",b={northwest:0,north:1,northeast:2,west:7,east:3,southwest:6,south:5,southeast:4},B={width:400,height:100,comps:[{type:"shape",points:{func:function(){for(var L=[10,8,162,36,314,37,269,2,398,49,268,98,314,58,161,60,9,91,103,49,10,8],g=0;g<L.length;g++){var q=L[g];q=0===g%2?q/400*B.width:q/100*B.height,L[g]=q}return B.width>120&&(L[4]=B.width-26,L[6]=B.width-40,L[10]=B.width-40,L[12]=B.width-26,L[18]=33),L}},segments:[1,3,2,2,2,2,3,2,2],background:"white",gradient:"linear.east",gradientColor:"red"}]},N={width:300,height:300,comps:[{type:"circle",rect:[20,0,120,120],background:X,rotation:.61},{type:"circle",rect:[200,120,70,70],background:X,rotation:.61},{type:"circle",rect:[200,220,70,70],background:X,rotation:.61},{type:"shape",points:[80,60,80,155,200,155],borderWidth:20,borderColor:X},{type:"shape",points:[80,60,80,255,200,255],borderWidth:20,borderColor:X}]},f={width:300,height:300,comps:[{type:"shape",points:[114,239,115,106,112,73,149,73,149,73,175,73,177,105,179,261,178,302,147,307,98,308,83,307,72,276,73,260,72,81,74,29,115,21,191,21,221,22,224,53,223,238],segments:[1,2,3,2,3,2,3,2,4,2,3,2,3,2],borderWidth:20,borderColor:G,rotation:.61}]},A={width:300,height:300,comps:[{type:"circle",rect:[210,0,90,90],background:X},{type:"circle",rect:[0,210,90,90],background:X},{type:"shape",points:[255,45,45,255],borderWidth:20,borderColor:X}]},Ih={width:300,height:300,comps:[{type:"shape",points:[20,20,280,280],borderWidth:30,borderColor:G},{type:"shape",points:[280,20,20,280],borderWidth:30,borderColor:G}]},Vr={width:300,height:300,comps:[{type:"shape",points:[270,30,30,150,270,270],borderWidth:40,borderColor:X}]},fp={width:300,height:300,comps:[{type:"shape",points:[30,30,270,150,30,270],borderWidth:40,borderColor:G}]},wi={width:300,height:300,comps:[{type:"rect",rect:[125.58,52.76,40,231.96],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000"},{type:"rect",rect:[27.87,61.06,150,30],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000",rotation:5.5},{type:"rect",rect:[113.36,61,150,30],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000",rotation:.79}]},ai={width:300,height:300,author:"",note:"",comps:[{type:"rect",rect:[135.15,38.76,28.63,82.84],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000"},{type:"triangle",rect:[94.69,2.35,110,44.77],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000"},{type:"rect",rect:[31.71,115.72,240,15],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000"},{type:"rect",rect:[31.71,167.62,240,15],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000"},{type:"rect",rect:[135.15,177.33,28.63,82.84],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000"},{type:"triangle",rect:[94.69,251.39,110,44.77],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000",rotation:3.14}]},no=function(v){var T=v.touches[0];return T?T:v.changedTouches[0]},kp=function(Y,M,p,g){return o(g-M,p-Y)},Ki=function(W,v){return{x:W.x*v,y:W.y*v}},fb=function(q,S){q.each(function(g){return q.isSelected(g)?S(g):void 0})},xp=function(s,a){s.reverseEach(function(y){return s.isSelected(y)?a(y):void 0})},xc=function(Q,q,M){var O,L,s,R,E,d=this,N=q,C=d.gv;if(Q instanceof t){s=Q.getSegments();var S=C.getDataUI(Q);E=S._55O.$15l,s&&s.size()||(s=Wd(E)),Q.isClosePath()&&s.indexOf(5)<0&&(s=new l(s._as),s.add(5)),O=$b(Q,S,N),L=E[O]}else{var W=C.getDataUI(Q);E=bc(W,Q.s("edge.points")),s=Q.s("edge.segments"),s&&s.size()||(s=Wd(E)),E=E._as,O=$b(Q,W,N),L=E[O]}if(s&&(R=s.get(N)),2===R||1===R||5===R){var m=E[O+1];5===R&&(m=E[0]);var D=jc(L,M,m);return D}return M},vo=function(J,m,y,x){var k=m/2,A=y/2,q=fs(J,-k,-A,x),F=fs(J,k,-A,x),l=fs(J,-k,A,x),Z=fs(J,k,A,x),H=fs(J,0,-A,x),o=fs(J,k,0,x),O=fs(J,0,A,x),L=fs(J,-k,0,x);return[q,F,l,Z,H,o,O,L]},jc=function(r,U,L){var D={x:U.x-r.x,y:U.y-r.y},Y={x:L.x-r.x,y:L.y-r.y},f=u(S(L.x-r.x,2)+S(L.y-r.y,2)),K={x:Y.x/f,y:Y.y/f},J=D.x*K.x+D.y*K.y,h={x:K.x*J,y:K.y*J};return{x:r.x+h.x,y:r.y+h.y}},fs=function(S,$,_,s){var h=a(s)*$-j(s)*_,g=j(s)*$+a(s)*_;return S?{x:S.x+h,y:S.y+g}:{x:h,y:g}},Ie=function(F,R){return R>2*F?F:R/2},Fp=function(s,l,h,Q){var H=y(s,l);return h=Q?V(h,H):Ie(h,H),H?h/=H:h=0,{x:s.x+(l.x-s.x)*h,y:s.y+(l.y-s.y)*h}},dm=function($,t){var A,k,J=$.gv,R=$._data,T=R._40I,g=R._41I,c=R.s("edge.offset"),S=R.s("edge.source.position"),P=R.s("edge.target.position"),z=R.s("edge.source.offset.x"),q=R.s("edge.source.offset.y"),B=R.s("edge.target.offset.x"),u=R.s("edge.target.offset.y"),C=R.s("edge.source.anchor.x"),b=R.s("edge.source.anchor.y"),N=R.s("edge.target.anchor.x"),F=R.s("edge.target.anchor.y");if(t?(A=e.getEdgeAgentPosition(J,T,S,z,q,C,b),k=e.getEdgeAgentPosition(J,g,P,B,u,N,F)):(A=e.getEdgeAgentPosition(J,T,S,0,0,C,b),k=e.getEdgeAgentPosition(J,g,P,0,0,N,F)),"points"===R.s("edge.type")&&c&&!R.s("edge.center")&&A){var f=R.s("edge.points")||new l,r=f.size(),n=Fp(A,r?f.get(0):k,c,r),X=Fp(k,r?f.get(r-1):A,c,r);A=n,k=X}return[A,k]},bc=function(I,e,O){var S=I._78o,o=I._data,t=o.s("edge.type"),D=[S.sourcePoint,S.targetPoint];return"points"===t?O&&(D=dm(I)):D=S.center?t?O?dm(I):dm(I,!0):O?dm(I):[S.c1,S.c2]:O?dm(I):dm(I,!0),e=new l(e?e._as:Z),e.add(D[0],0),e.add(D[1]),e},Ko=function(D){return D=new l(D._as),D.removeAt(0),D.removeAt(D.size()-1),D},Wd=function(N){N._as||(N=new l(N));var L=new l;L.add(1);for(var W=1;W<N.size();W++)L.add(2);return L},bd=function(_,p){return{x:(_.x+p.x)/2,y:(_.y+p.y)/2}},$j=function(q,G){return{x:q.x+1*(G.x-q.x)/4,y:q.y+1*(G.y-q.y)/4}},Zb=function(G,D){return{x:G.x+3*(D.x-G.x)/4,y:G.y+3*(D.y-G.y)/4}},Zp=function(e,K,L,Q){var f=K.x+K.width/2,$=K.y+K.height/2,k=u(f*f+$*$),l=o($,f)+L;return{x:Q.x+k*a(l),y:Q.y+k*j(l)}},Mp=q.validateImpl,Df=q.isRectEditable,jj=q.isPointEditable,_b=q._42,Ck=L._79o,kk=M._79o,Vf=L._48O,ac=L._47O,zr=n._48O,Ar=n._80o,Yk=L._80o,sn=n.getSelectWidth,Pp=n._47O,uc=M._47O,tc=q.isEditable,Vo=["northwest","north","northeast","east","southeast","south","southwest","west"],Lm=function(I,o,L,_,g,Q,h,N,v,K){var r=I.x,a=I.y,A=I.width,X=I.height,f={x:r+A/2,y:a+X/2};_=_||0,o=fs(f,o.x-f.x,o.y-f.y,-_),h&&!N&&(o.x+=v,o.y+=K);var w=.01;if("northwest"===L?(o.x+g>r+A-w&&(o.x=r+A-g-w),o.y+g>a+X-w&&(o.y=a+X-g-w),I=m(o,{x:r+A,y:a+X})):"north"===L?(o.y+g>a+X-w&&(o.y=a+X-g-w),I=m({x:r,y:o.y},{x:r+A,y:a+X})):"northeast"===L?(o.x<r+g+w&&(o.x=r+g+w),o.y+g>a+X-w&&(o.y=a+X-g-w),I=m({x:r,y:o.y},{x:o.x,y:a+X})):"west"===L?(o.x+g>r+A-w&&(o.x=r+A-g-w),I=m({x:o.x,y:a},{x:r+A,y:a+X})):"east"===L?(o.x<r+g+w&&(o.x=r+g+w),I=m({x:r,y:a},{x:o.x,y:a+X})):"southwest"===L?(o.x+g>r+A-w&&(o.x=r+A-g-w),o.y<a+g+w&&(o.y=a+g+w),I=m({x:o.x,y:a},{x:r+A,y:o.y})):"south"===L?(o.y<a+g+w&&(o.y=a+g+w),I=m({x:r,y:a},{x:r+A,y:o.y})):"southeast"===L&&(o.x<r+g+w&&(o.x=r+g+w),o.y<a+g+w&&(o.y=a+g+w),I=m({x:r,y:a},o)),"keepRatio"===Q&&(!h&&N||h&&!N)&&("northeast"===L||"southeast"===L||"northwest"===L||"southwest"===L)){var d=I.width,C=I.height,e=d/A,P=C/X,y=V(e,P);I.width=A*y,I.height=X*y,"northeast"===L?I.y=a+(X-I.height):"northwest"===L?(I.y=a+(X-I.height),I.x=r+(A-I.width)):"southwest"===L&&(I.x=r+(A-I.width))}I.x-=f.x,I.y-=f.y;var B=Zp(Z,I,_,f);return I.x=B.x-I.width/2,I.y=B.y-I.height/2,I},wr=function(G,K,y,D){var o=G.getRotation(),p=K,I=p.x,M=p.y,X=p.width,k=p.height,P={x:I+p.width/2,y:M+p.height/2};D=fs(P,D.x-P.x,D.y-P.y,-o),"northwest"===y?p=m(D,{x:I+X,y:M+k}):"north"===y?p=m({x:I,y:D.y},{x:I+X,y:M+k}):"northeast"===y?p=m({x:I,y:D.y},{x:D.x,y:M+k}):"west"===y?p=m({x:D.x,y:M},{x:I+X,y:M+k}):"east"===y?p=m({x:I,y:M},{x:D.x,y:M+k}):"southwest"===y?p=m({x:D.x,y:M},{x:I+X,y:D.y}):"south"===y?p=m({x:I,y:M},{x:I+X,y:D.y}):"southeast"===y&&(p=m({x:I,y:M},D)),G.setRect(p),p.x-=P.x,p.y-=P.y;var w=Zp(G,p,o,P);G.p(w.x,w.y)},Zh=function(O,r,F,P,z,x,w,s){var o=Z;x?(o=fs(Z,z.x-r.x,z.y-r.y,-F),o.x-=w.x,o.y-=w.y):o=fs(Z,z.x-r.x,z.y-r.y,0);var Y={x:r.x+o.x,y:r.y+o.y};s&&(Y=s(Y.x,Y.y)),Y.e=O.getPoints().get(P).e,O.setPoint(P,Y);var y=O.getWidth(),N=O.getHeight(),u=O.p().x-y/2,J=O.p().y-N/2;u-=r.x,J-=r.y;var U=Zp(O,{x:u,y:J,width:y,height:N},F,r);O.p(U.x,U.y)},$b=function(H,Y,A){var _,j;if(H instanceof t?(_=H.getPoints(),j=H.getSegments()):H instanceof U&&"points"===H.s("edge.type")&&(_=H.s("edge.points"),j=H.s("edge.segments"),_=bc(Y,_)),j&&j.size()||(j=Wd(_)),H instanceof t&&H.isClosePath()&&j.indexOf(5)<0&&(j=new l(j._as),j.add(5)),j)for(var d=-1,M=0;M<j.size();M++){if(M===A)return d;var C=j.get(M);1===C?d+=1:2===C?d+=1:3===C?d+=2:4===C&&(d+=3)}},Hb=function(i,q,r){var c,x;if(i instanceof t?(c=i.getPoints(),x=i.getSegments()):i instanceof U&&"points"===i.s("edge.type")&&(c=i.s("edge.points"),x=i.s("edge.segments"),c=bc(q,c)),x&&x.size()||(x=Wd(c)),x)for(var u=-1,O=0;O<x.size();O++){var E=x.get(O);if(1===E?u+=1:2===E?u+=1:3===E?u+=2:4===E&&(u+=3),u===r)return O}},Cf=function(c,X){var h=[c[0]-X[0],c[1]-X[1],c[2]-X[2]];return h},cj=function(){var P=new O(16);return P[0]=1,P[1]=0,P[2]=0,P[3]=0,P[4]=0,P[5]=1,P[6]=0,P[7]=0,P[8]=0,P[9]=0,P[10]=1,P[11]=0,P[12]=0,P[13]=0,P[14]=0,P[15]=1,P},mp=function(J,X){var H=J[0],N=J[1],B=J[2];return J[0]=X[0]*H+X[4]*N+X[8]*B+X[12],J[1]=X[1]*H+X[5]*N+X[9]*B+X[13],J[2]=X[2]*H+X[6]*N+X[10]*B+X[14],J},tf=function(s,y){if(y){var g=j(y),Z=a(y),$=s[0],p=s[1],z=s[2],e=s[3],H=s[8],L=s[9],u=s[10],n=s[11];s[0]=$*Z-H*g,s[1]=p*Z-L*g,s[2]=z*Z-u*g,s[3]=e*Z-n*g,s[8]=$*g+H*Z,s[9]=p*g+L*Z,s[10]=z*g+u*Z,s[11]=e*g+n*Z}},nj=function(Y,p){for(var Z=Y.s("grid.row.count"),s=Y.s("grid.column.count"),g=0;Z>g;g++)for(var c=0;s>c;c++){var h=Y.getCellRect(g,c);if(F(h,p))return{rowIndex:g,columnIndex:c,rect:h,grid:Y}}return null},Be=function(A,p,z,X,O,x){var b={},Q=z-A,k=X-p,E=i.sqrt(Q*Q+k*k),s=Q/E,U=k/E,q=(-A+O)*s+(-p+x)*U;return 0>=q?(b.x=A,b.y=p):q>=E?(b.x=z,b.y=X):(b.x=A+q*s,b.y=p+q*U),Q=O-b.x,k=x-b.y,b.z=i.sqrt(Q*Q+k*k),b},ah=function(w,J){var L,n,R,G,b,_,K,T,r=w.getPoints(),M=w.getSegments(),I=w.p(),S=w.getRotation();if(!M||!(M.indexOf(3)>0||M.indexOf(4)>0)){for(T=0;T<=r.size()-1;T++)if(T===r.size()-1?(b=r.get(0),G=r.get(T)):(G=r.get(T),b=r.get(T+1)),G=fs(I,G.x-I.x,G.y-I.y,S),b=fs(I,b.x-I.x,b.y-I.y,S),_=Be(G.x,G.y,b.x,b.y,J.x,J.y),K=_.z,K<(w.s("shape.border.width")||10)){n=G,R=b,L=T;break}if(L!=Z){var d=Be(n.x,n.y,R.x,R.y,J.x,J.y),u=y(n,d);return{attachIndex:L,attachOffset:u}}}},Lj=function(H){for(var $=H._data,W=$.p(),L=$.getRotation(),T=$.getPoints(),Q=Z,n=[],_=0;_<T.size();_++)Q=T.get(_),n.push(fs(W,Q.x-W.x,Q.y-W.y,L));H._55O.$15l=n};T.setImage("xeditinteractor_parentIcon",N),T.setImage("xeditinteractor_hostIcon",f),T.setImage("xeditinteractor_edgeIcon",A),T.setImage("xeditinteractor_removeIcon",Ih),T.setImage("xeditinteractor_sourceIcon",Vr),T.setImage("xeditinteractor_targetIcon",fp),T.setImage("xeditinteractor_elevationIcon",wi),T.setImage("xeditinteractor_tallIcon",ai),q._editPointSize=E?24:9,q._edgeHelpers=["parent","remove","source","target"],q._leftTopHelpers=["parent"],q._rightTopHelpers=["host"],q._leftBottomHelpers=["edge"],q._rightBottomHelpers=["remove"],Vo=Vo.concat(Vo).concat(Vo),M._79o=function(){var C=this,G=C.gv,T=G.getZoom(),o=G._editInteractor,l=kk.call(C);if(!l)return null;var M=dm(C,!0),L=M[0],q=M[1],n={x:l.x,y:l.y,width:l.width,height:l.height},$=m(L,q);if(o instanceof _.XEditInteractor){n=c(n,$);var r=C._55O,X=G.getEditPointSize()/T+2,j=0;r&&r._43O&&(j+=X/2,z(n,j))}return n},M._47O=function(L){var l=this,$=l.gv,i=$._editInteractor;i instanceof _.XEditInteractor||uc.call(l,L)},M.rectIntersects=function(t){var z=this,g=z._data,c=z.gv,F=c.getZoom(),v=z._55O,n=c._editInteractor;if(n instanceof _.XEditInteractor&&c.isEditable(g)&&v&&v._43O&&"points"===g.s("edge.type")){var U=g.s("edge.points"),R=g.s("edge.segments");U=bc(z,U),R&&R.size()||(R=Wd(U)),U=U._as;var M=!1,W=E?5:1,V=t.x+W,w=t.y+W,y={x:V,y:w};if(n._edge===g&&n._hoverSegmentIndex>=0){var B=c._editInteractor._hoverSegmentIndex,d=R.get(B),O=$b(g,z,B),e=Z;if(O!=Z&&O>=0){var A=U[O],o=c.getSegmentHoverWidth()/F;if(2===d||1===d){var p=U[O+1];e=Yq(new Rp(A.x,A.y),new Rp(p.x,p.y),new Rp(y.x-o,y.y-o),new Rp(y.x+2*o,y.y+2*o)),e.$62l===x&&(M=!0)}else if(3===d){var L=U[O+1],p=U[O+2];e=Pr(new Rp(A.x,A.y),new Rp(L.x,L.y),new Rp(p.x,p.y),new Rp(y.x-o,y.y-o),new Rp(y.x+2*o,y.y+2*o)),e.$62l===x&&(M=!0)}else if(4===d){var f=U[O+1],J=U[O+2];p=U[O+3],e=fk(new Rp(A.x,A.y),new Rp(f.x,f.y),new Rp(J.x,J.y),new Rp(p.x,p.y),new Rp(y.x-o,y.y-o),new Rp(y.x+2*o,y.y+2*o)),e.$62l===x&&(M=!0)}}}if(M)return!0}return Z},L._47O=function(f){var s=this,J=s.gv,u=J._editInteractor;u instanceof _.XEditInteractor||ac.call(s,f)},L.rectIntersects=function(w){var C=this,f=C._data,O=C.gv,p=O.getZoom(),Y=C._55O,c=O._editInteractor;if(c instanceof _.XEditInteractor&&O.isEditable(f)&&Y&&Y._43O){var W=Y.$15l,d=!1,V=E?5:1,A=w.x+V,t=w.y+V,U={x:A,y:t};if(W&&W.length===f.getPoints().size()||(Lj(C),W=Y.$15l),c._shape===f&&c._hoverSegmentIndex>=0){var r=f.getSegments();r&&r.size()||(r=Wd(W));var M=O._editInteractor._hoverSegmentIndex,s=r.get(M),e=$b(f,C,M),S=Z;if(e!=Z&&e>=0){var $=W[e],N=O.getSegmentHoverWidth()/p;if(2===s||1===s){var Q=W[e+1];S=Yq(new Rp($.x,$.y),new Rp(Q.x,Q.y),new Rp(U.x-N,U.y-N),new Rp(U.x+2*N,U.y+2*N)),S.$62l===x&&(d=!0)}else if(3===s){var z=W[e+1],Q=W[e+2];S=Pr(new Rp($.x,$.y),new Rp(z.x,z.y),new Rp(Q.x,Q.y),new Rp(U.x-N,U.y-N),new Rp(U.x+2*N,U.y+2*N)),S.$62l===x&&(d=!0)}else if(4===s){var o=W[e+1],v=W[e+2];Q=W[e+3],S=fk(new Rp($.x,$.y),new Rp(o.x,o.y),new Rp(v.x,v.y),new Rp(Q.x,Q.y),new Rp(U.x-N,U.y-N),new Rp(U.x+2*N,U.y+2*N)),S.$62l===x&&(d=!0)}}}if(d)return!0}return Z},L._48O=function(){var v=this,e=v.gv,$=e._editInteractor;$ instanceof _.XEditInteractor?(n._48O.call(v),v._55O._43O&&Lj(v)):Vf.call(v)},L._79o=function(){var M=this,i=M.gv,y=i.getZoom(),g=i._editInteractor,B=Ck.call(M);if(B){var o={x:B.x,y:B.y,width:B.width,height:B.height};if(g instanceof _.XEditInteractor){var h=M._55O,X=i.getEditPointSize()/y+2,O=0;h&&h._43O&&(O+=X/2,z(o,O))}return o}},n._47O=function(Z){var q=this,e=q.gv,d=e._editInteractor;if(d instanceof _.XEditInteractor);else{var o=q._55O;o&&o._98o&&Pp.call(q,Z)}},n.getSelectWidth=function(){var W=this,N=W.gv,E=N._editInteractor,m=W._data;return N.isEditable(m)&&E instanceof _.XEditInteractor?0:sn.call(W)},n._80o=function(z){var I=this,v=I.gv._editInteractor;if(Ar.call(I,z),v&&v._debug){z.save(),z.beginPath(),z.lineWidth=1,z.strokeStyle="green";var Q=I._79o();Q&&(z.rect(Q.x,Q.y,Q.width,Q.height),z.stroke()),z.restore()}},L._80o=function(l){var x=this,$=x.gv._editInteractor;if(Yk.call(x,l),$&&$._debug){l.save(),l.beginPath(),l.lineWidth=1,l.strokeStyle="green";var r=x._79o();l.rect(r.x,r.y,r.width,r.height),l.stroke(),l.restore()}},n._48O=function(){var l=this,z=l.gv,s=l._data,p=z._editInteractor,G=l._55O,X=s.p(),c=s.getRotation();if(p instanceof _.XEditInteractor){if(G._42O){var S=vo(X,s.getWidth(),s.getHeight(),c),q=S[0],K=S[1],Q=S[2],O=S[3],E=S[4],$=S[5],J=S[6],i=S[7];G.$45l=[q,E,K,$,O,J,Q,i]}}else zr.call(l)},q.getResizeMode=function(){return this.$25l||"normal"},q.setResizeMode=function(l){var q=this.$25l;this.$25l=l,this.fp("resizeMode",q,l)},q.getSnapAngle=function(){return this.$26l||Math.PI/36},q.setSnapAngle=function(u){var m=this.$26l;this.$26l=u,this.fp("snapAngle",m,u)},q.getSnapSpacing=function(){return this.$27l},q.setSnapSpacing=function(o){var u=this.$27l;this.$27l=o,this.fp("snapSpacing",u,o)},q.getPointSnapSpacing=function(){return this._pointSnapSpacing},q.setPointSnapSpacing=function(J){var m=this._pointSnapSpacing;this._pointSnapSpacing=J,this.fp("pointSnapSpacing",m,J)},q.setHelperEditableFunc=function(y){var B=this._helperEditableFunc;this._helperEditableFunc=y,this.fp("helperEditableFunc",B,y)},q.getHelperEditableFunc=function(){return this._helperEditableFunc},q.setLeftTopHelpers=function(F){var R=this._leftTopHelpers;this._leftTopHelpers=F,this.fp("leftTopHelpers",R,F)},q.getLeftTopHelpers=function(){return this._leftTopHelpers},q.setLeftTopHelpersAlign=function(q){var Q=this._leftTopHelpersAlign;this._leftTopHelpersAlign=q,this.fp("leftTopHelpersAlign",Q,q)},q.getLeftTopHelpersAlign=function(){return this._leftTopHelpersAlign},q.setRightTopHelpers=function(W){var E=this._rightTopHelpers;this._rightTopHelpers=W,this.fp("rightTopHelpers",E,W)},q.getRightTopHelpers=function(){return this._rightTopHelpers},q.setRightTopHelpersAlign=function(c){var S=this._rightTopHelpersAlign;this._rightTopHelpersAlign=c,this.fp("rightTopHelpersAlign",S,c)},q.getRightTopHelpersAlign=function(){return this._rightTopHelpersAlign},q.setLeftBottomHelpers=function(b){var V=this._leftBottomHelpers;this._leftBottomHelpers=b,this.fp("leftBottomHelpers",V,b)},q.getLeftBottomHelpers=function(){return this._leftBottomHelpers},q.setLeftBottomHelpersAlign=function(V){var j=this._leftBottomHelpersAlign;this._leftBottomHelpersAlign=V,this.fp("leftBottomHelpersAlign",j,V)},q.getLeftBottomHelpersAlign=function(){return this._leftBottomHelpersAlign},q.setRightBottomHelpers=function(r){var J=this._rightBottomHelpers;this._rightBottomHelpers=r,this.fp("rightBottomHelpers",J,r)},q.getRightBottomHelpers=function(){return this._rightBottomHelpers},q.setRightBottomHelpersAlign=function(g){var X=this._rightBottomHelpersAlign;this._rightBottomHelpersAlign=g,this.fp("rightBottomHelpersAlign",X,g)},q.getRightBottomHelpersAlign=function(){return this._rightBottomHelpersAlign},q.setEdgeHelpers=function(f){var S=this._edgeHelpers;this._edgeHelpers=f,this.fp("edgeHelpers",S,f)},q.getEdgeHelpers=function(){return this._edgeHelpers},q.isHelperEditable=function(h,G){return h instanceof U&&("host"===G||"edge"===G||"elevation"===G||"tall"===G)?!1:h instanceof H&&("source"===G||"target"===G)?!1:"pointElevation"===G?this._helperEditableFunc?this._helperEditableFunc(h,G):!1:this._helperEditableFunc?this._helperEditableFunc(h,G):!0},q.getEditHelperSize=function(){return this._editHelperSize||(E?28:16)},q.setEditHelperSize=function(X){var W=this._editHelperSize;this._editHelperSize=X,this.fp("editHelperSize",W,X)},q.getEditRectBorderColor=function(){return this.$28l||"rgb(0, 168, 255)"},q.setEditRectBorderColor=function(G){var z=this.$28l;this.$28l=G,this.fp("editRectBorderColor",z,G)},q.getNodeBorderColor=function(){return this.$29l||"#1ABC9C"},q.setNodeBorderColor=function(K){var t=this.$29l;this.$29l=K,this.fp("nodeBorderColor",t,K)},q.getEditRectBorderStyle=function(){return this.$30l||"dashed"},q.setEditRectBorderStyle=function(A){var L=this.$30l;this.$30l=A,this.fp("editRectBorderStyle",L,A)},q.getControlPointBackground=function(){return this.$31l||"#ff0"},q.setControlPointBackground=function(N){var v=this.$31l;this.$31l=N,this.fp("controlPointBackground",v,N)},q.getControlPointBorderColor=function(){return this.$32l||this._editPointBorderColor},q.setControlPointBorderColor=function(N){var T=this.$32l;this.$32l=N,this.fp("controlPointBorderColor",T,N)},q.getJoinPointBackground=function(){return this.$33l||this._editPointBackground},q.setJoinPointBackground=function(r){var j=this.$33l;this.$33l=r,this.fp("joinPointBackground",j,r)},q.getJoinPointBorderColor=function(){return this.$34l||this._editPointBorderColor},q.setJoinPointBorderColor=function(i){var x=this.$34l;this.$34l=i,this.fp("joinPointBorderColor",x,i)},q.getDirectionLineColor=function(){return this.$35l||"#888"},q.setDirectionLineColor=function($){var H=this.$35l;this.$35l=$,this.fp("directionLineColor",H,$)},q.getSegmentHoverColor=function(){return this.$36l||"rgba(255, 0, 0, 0.3)"},q.setSegmentHoverColor=function(V){var U=this.$36l;this.$36l=V,this.fp("segmentHoverColor",U,V)},q.getSegmentHoverWidth=function(){return this.$22l||(E?16:8)},q.setSegmentHoverWidth=function(f){var K=this.$22l;this.$22l=f,this.fp("segmentHoverWidth",K,f)},q.getSnapPointBorderColor=function(){return this.$38l||"#f00"},q.setSnapPointBorderColor=function(_){var J=this.$38l;this.$38l=_,this.fp("snapPointBorderColor",J,_)},q.getEditRectPadding=function(){return this.$39l!=Z?this.$39l:6},q.setEditRectPadding=function(f){var m=this.$39l;this.$39l=f,this.fp("editRectPading",m,f)},q.isRectEditable=function(I){var y=this,T=y._editInteractor;return T instanceof _.XEditInteractor?y._rectEditableFunc?y._rectEditableFunc(I):!0:Df.call(y,I)},q.isPointEditable=function(l){var X=this,j=X._editInteractor;return j instanceof _.XEditInteractor?X._pointEditableFunc?X._pointEditableFunc(l):!0:jj.call(X,l)},q.validateImpl=function(){var m=this,H=m.$14l,C=m._editInteractor;if(H){var w=m.getWidth(),f=m.getHeight();(w!==H.clientWidth||f!==H.clientHeight)&&(C&&(C._68I=1),e.setCanvas(H,w,f),m._32I=1)}Mp.call(this)},q.isEditable=function(O){var d=tc.call(this,O),A=this._editInteractor;if(A instanceof _.XEditInteractor&&O instanceof U){if(!O.s("2d.editable"))return!1;var V=this.getEditableFunc();d=V?V(O):!0}return d},q._42=function(k,K){var C=this,l=C._editInteractor;_b.call(C,k,K),l instanceof _.XEditInteractor&&l._68I&&l._42()},q.isSnapPoint=function(){return!0};var Ii=function(J){arguments.length>0&&this.$58l(J)},af=Ii.prototype;af.$58l=function(v){this.$62l=v,this.points=new Array},af.$56l=function(N){this.points.push(N)},af.$57l=function(Z){this.points=this.points.concat(Z)};var Rp=function(b,D){arguments.length>0&&this.$58l(b,D)},gj=Rp.prototype;gj.$58l=function(B,c){this.x=B,this.y=c},gj.add=function(a){return new Rp(this.x+a.x,this.y+a.y)},gj.addEquals=function(u){return this.x+=u.x,this.y+=u.y,this},gj.$55l=function(L){return new Rp(this.x*L,this.y*L)},gj.eq=function(e){return this.x==e.x&&this.y==e.y},gj.lt=function(N){return this.x<N.x&&this.y<N.y},gj.lte=function(p){return this.x<=p.x&&this.y<=p.y},gj.gt=function(b){return this.x>b.x&&this.y>b.y},gj.gte=function(r){return this.x>=r.x&&this.y>=r.y},gj.lerp=function(n,s){return new Rp(this.x+(n.x-this.x)*s,this.y+(n.y-this.y)*s)},gj.distanceFrom=function(o){var W=this.x-o.x,c=this.y-o.y;return u(W*W+c*c)},gj.min=function(B){return new Rp(V(this.x,B.x),V(this.y,B.y))},gj.max=function(t){return new Rp(D(this.x,t.x),D(this.y,t.y))},gj.toString=function(){return this.x+","+this.y};var Oh=function(){this.$58l(arguments)},gp=Oh.prototype;Oh.TO=1e-6,Oh.AC=6,gp.$58l=function(z){this.co=new Array;for(var b=z.length-1;b>=0;b--)this.co.push(z[b])},gp.$55l=function(N){for(var y=new Oh,$=0;$<=this.$50l()+N.$50l();$++)y.co.push(0);for(var $=0;$<=this.$50l();$++)for(var S=0;S<=N.$50l();S++)y.co[$+S]+=this.co[$]*N.co[S];return y},gp.$59l=function(){for(var F=this.$50l();F>=0&&v(this.co[F])<=Oh.TO;F--)this.co.pop()},gp.$50l=function(){return this.co.length-1},gp.$51l=function(){var g;switch(this.$59l(),this.$50l()){case 0:g=new Array;break;case 1:g=this.$52l();break;case 2:g=this.$53l();break;case 3:g=this.$54l();break;case 4:g=this.$63l();break;default:g=new Array}return g},gp.$52l=function(){var e=new Array,g=this.co[1];return 0!=g&&e.push(-this.co[0]/g),e},gp.$53l=function(){var Z=new Array;if(2==this.$50l()){var P=this.co[2],f=this.co[1]/P,U=this.co[0]/P,M=f*f-4*U;if(M>0){var W=u(M);Z.push(.5*(-f+W)),Z.push(.5*(-f-W))}else 0==M&&Z.push(.5*-f)}return Z},gp.$63l=function(){var M=new Array;if(4==this.$50l()){var I=this.co[4],S=this.co[3]/I,z=this.co[2]/I,g=this.co[1]/I,B=this.co[0]/I,t=new Oh(1,-z,S*g-4*B,-S*S*B+4*z*B-g*g).$54l(),y=t[0],W=S*S/4-z+y;if(v(W)<=Oh.TO&&(W=0),W>0){var a=u(W),w=3*S*S/4-a*a-2*z,_=(4*S*z-8*g-S*S*S)/(4*a),$=w+_,F=w-_;if(v($)<=Oh.TO&&($=0),v(F)<=Oh.TO&&(F=0),$>=0){var f=u($);M.push(-S/4+(a+f)/2),M.push(-S/4+(a-f)/2)}if(F>=0){var f=u(F);M.push(-S/4+(f-a)/2),M.push(-S/4-(f+a)/2)}}else if(0>W);else{var _=y*y-4*B;if(_>=-Oh.TO){if(0>_&&(_=0),_=2*u(_),w=3*S*S/4-2*z,w+_>=Oh.TO){var Y=u(w+_);M.push(-S/4+Y/2),M.push(-S/4-Y/2)}if(w-_>=Oh.TO){var Y=u(w-_);M.push(-S/4+Y/2),M.push(-S/4-Y/2)}}}}return M},gp.$54l=function(){var T=new Array;if(3==this.$50l()){var U=this.co[3],z=this.co[2]/U,f=this.co[1]/U,R=this.co[0]/U,b=(3*f-z*z)/3,i=(2*z*z*z-9*f*z+27*R)/27,m=z/3,g=i*i/4+b*b*b/27,J=i/2;if(v(g)<=Oh.TO&&(g=0),g>0){var k,r,A=u(g);k=-J+A,r=k>=0?S(k,1/3):-S(-k,1/3),k=-J-A,k>=0?r+=S(k,1/3):r-=S(-k,1/3),T.push(r-m)}else if(0>g){var B=u(-b/3),s=o(u(-g),-J)/3,E=a(s),G=j(s),Z=u(3);T.push(2*B*E-m),T.push(-B*(E+Z*G)-m),T.push(-B*(E-Z*G)-m)}else{var k;k=J>=0?-S(J,1/3):S(-J,1/3),T.push(2*k-m),T.push(-k-m)}}return T};var xk=function(B,O){arguments.length>0&&this.$58l(B,O)},vk=xk.prototype;vk.$58l=function(X,D){this.x=X,this.y=D},vk.length=function(){return u(this.x*this.x+this.y*this.y)},vk.$60l=function(P){return this.x*P.x+this.y*P.y};var Pg=function(i,K,X,I){var t,b=(I.x-X.x)*(i.y-X.y)-(I.y-X.y)*(i.x-X.x),M=(K.x-i.x)*(i.y-X.y)-(K.y-i.y)*(i.x-X.x),H=(I.y-X.y)*(K.x-i.x)-(I.x-X.x)*(K.y-i.y);if(0!=H){var m=b/H,h=M/H;m>=0&&1>=m&&h>=0&&1>=h?(t=new Ii(x),t.points.push(new Rp(i.x+m*(K.x-i.x),i.y+m*(K.y-i.y)))):t=new Ii(R)}else t=0==b||0==M?new Ii("C"):new Ii("P");return t},_m=function(B,u,H,l,D){var y,n,C,t,E,O,Y,w=l.min(D),$=l.max(D),U=new Ii(R);y=u.$55l(-2),C=B.add(y.add(H)),y=B.$55l(-2),n=u.$55l(2),t=y.add(n),E=new Rp(B.x,B.y),Y=new xk(l.y-D.y,D.x-l.x),O=l.x*D.y-D.x*l.y;for(var r=new Oh(Y.$60l(C),Y.$60l(t),Y.$60l(E)+O).$51l(),f=0;f<r.length;f++){var i=r[f];if(i>=0&&1>=i){var G=B.lerp(u,i),b=u.lerp(H,i),p=G.lerp(b,i);l.x==D.x?w.y<=p.y&&p.y<=$.y&&(U.$62l=x,U.$56l(p)):l.y==D.y?w.x<=p.x&&p.x<=$.x&&(U.$62l=x,U.$56l(p)):p.gte(w)&&p.lte($)&&(U.$62l=x,U.$56l(p))}}return U},Pr=function(C,S,s,i,A){var B=i.min(A),O=i.max(A),u=new Rp(O.x,B.y),E=new Rp(B.x,O.y),X=_m(C,S,s,B,u),v=_m(C,S,s,u,O),k=_m(C,S,s,O,E),l=_m(C,S,s,E,B),n=new Ii(R);return n.$57l(X.points),n.$57l(v.points),n.$57l(k.points),n.$57l(l.points),n.points.length>0&&(n.$62l=x),n},kh=function(G,Y,N,z,r,a){var q,S,J,l,c,T,W,X,g,e,E=r.min(a),L=r.max(a),s=new Ii(R);q=G.$55l(-1),S=Y.$55l(3),J=N.$55l(-3),l=q.add(S.add(J.add(z))),c=new xk(l.x,l.y),q=G.$55l(3),S=Y.$55l(-6),J=N.$55l(3),l=q.add(S.add(J)),T=new xk(l.x,l.y),q=G.$55l(-3),S=Y.$55l(3),J=q.add(S),W=new xk(J.x,J.y),X=new xk(G.x,G.y),e=new xk(r.y-a.y,a.x-r.x),g=r.x*a.y-a.x*r.y;for(var h=new Oh(e.$60l(c),e.$60l(T),e.$60l(W),e.$60l(X)+g).$51l(),$=0;$<h.length;$++){var K=h[$];if(K>=0&&1>=K){var y=G.lerp(Y,K),I=Y.lerp(N,K),m=N.lerp(z,K),p=y.lerp(I,K),j=I.lerp(m,K),Z=p.lerp(j,K);r.x==a.x?E.y<=Z.y&&Z.y<=L.y&&(s.$62l=x,s.$56l(Z)):r.y==a.y?E.x<=Z.x&&Z.x<=L.x&&(s.$62l=x,s.$56l(Z)):Z.gte(E)&&Z.lte(L)&&(s.$62l=x,s.$56l(Z))}}return s},fk=function(W,M,T,I,D,z){var H=D.min(z),X=D.max(z),p=new Rp(X.x,H.y),O=new Rp(H.x,X.y),S=kh(W,M,T,I,H,p),E=kh(W,M,T,I,p,X),i=kh(W,M,T,I,X,O),V=kh(W,M,T,I,O,H),t=new Ii(R);return t.$57l(S.points),t.$57l(E.points),t.$57l(i.points),t.$57l(V.points),t.points.length>0&&(t.$62l=x),t},Yq=function(C,i,d,I){var t=d.min(I),w=d.max(I),T=new Rp(w.x,t.y),m=new Rp(t.x,w.y),e=Pg(t,T,C,i),N=Pg(T,w,C,i),W=Pg(w,m,C,i),r=Pg(m,t,C,i),$=new Ii(R);return $.$57l(e.points),$.$57l(N.points),$.$57l(W.points),$.$57l(r.points),$.points.length>0&&($.$62l=x),$},cb=_.XEditInteractor=function(g){var c=this,p=c._view=document.createElement("canvas");p.className="editCanvas",p.style.position="absolute",cb.superClass.constructor.call(c,g)};T.def(cb,_.Interactor,{ms_edit:1,setUp:function(){var F=this,$=F.gv,z=$.getView(),J=F._view;cb.superClass.setUp.call(F),$.setEditInteractor(F),$.$14l=J,$._79O?z.insertBefore(J,$._79O):z.appendChild(J);var C=F.$49l=F.$11l.bind(F);$.dm().md(C),$.sm().ms(C),$.mp(C)},tearDown:function(){var b=this,K=b.gv,L=K.getView(),p=b.$49l;cb.superClass.tearDown.call(b),K.setEditInteractor(Z),K.$14l=Z,L.removeChild(b._view),K.dm().umd(p),K.sm().ums(p),K.ump(p)},clear:function(){var d=this,L=d.gv;delete d._hoverSegmentIndex,delete d._edge,delete d._shape,delete L._editing,delete d.$10l,delete d.$13l,delete d.$9l,delete d._removePointIndex,delete d._lp,d.$12l="",delete d.$40l,delete d.$67l,delete d.$72l,delete d.$73l,delete d.$75l,delete d.$1l,delete d.$3l,delete d.$2l,delete d.$92l,delete d.$93l,delete d.$94l,d.clearDragging()},handle_keydown:function(P){this.$48l!==P.shiftKey&&(this.$48l=P.shiftKey,this.handle_mousemove(P,k,!0))},handle_keyup:function(K){this.$48l!==K.shiftKey&&(this.$48l=K.shiftKey,this.handle_mousemove(K,k,!0))},handle_touchstart:function(m){this.handle_mousemove(m),this.handle_mousedown(m)},handle_mousedown:function(K){d(K);var I=this,F=I.$13l,J=I.gv,Z=J.dm(),k=J.sm(),r=J.getZoom(),L=J.lp(K),o=T.isDoubleClick(K),x=T.isLeftButton(K),u=I.$7l,i=I._shape,U=I._hoverSegmentIndex,P=I._edge,n=I.$87l,D=I.$88l,B=function(){I._68I||n===I.$87l&&D===I.$88l||I.$43l()};if(7!==I.$67l&&(delete I.$87l,delete I.$88l),x&&(i||P)&&U>=0&&o&&(i&&k.contains(i)||P&&k.contains(P))){var X=xc.call(I,i||P,U,L);return I.addShapePoint(i||P,U,X),g(function(){I.handle_mousemove(K)},40),void 0}if(x&&(i||P)&&I._removePointIndex>=0&&o)return I.removeShapePoint(),I.$5l=1,g(function(){I.handle_mousemove(K)},40),void 0;if(!x||!J._editing)return B(),void 0;if(i&&F>=0){var c=i.getPoints().get(F),$=i.p(),a=fs($,c.x-$.x,c.y-$.y,-u+i.getRotation());l=fs($,L.x-$.x,L.y-$.y,-u),I.$24l={x:l.x-a.x,y:l.y-a.y},I.startDragging(K),Z.beginTransaction(),I.fi({kind:"beginEditPoint",event:K,data:i,index:F}),I.$88l=F,I.$87l=i}else if(I.$10l){var y=J.sm().getSelection(),Q=I.$6l,C=I.$1l={},z=I.$3l={},V=I.$16l[b[I.$10l]],h={x:Q.x,y:Q.y},W={x:Q.x+Q.width/2,y:Q.y+Q.height/2};I.$24l={x:L.x-V.x/r,y:L.y-V.y/r},I.$2l=p(I.$8l),I.$4l=p(Q),y.each(function(m){if(m instanceof H){var t=m.p(),Z=m.getWidth(),A=m.getHeight(),X=fs(W,t.x-W.x,t.y-W.y,-u);C[m.getId()]={x:t.x-Z/2,y:t.y-A/2,width:Z,height:A},z[m.getId()]={x:(X.x-h.x)/Q.width,y:(X.y-h.y)/Q.height}}}),I.startDragging(K),Z.beginTransaction(),I.fi({kind:"beginEditRect",event:K,direction:I.$10l})}else if(P&&F>=0){var M=bc(J.getDataUI(P),P.s("edge.points")),c=M.get(F);I.$24l={x:L.x-c.x,y:L.y-c.y},I.startDragging(K),Z.beginTransaction(),I.fi({kind:"beginEditPoint",event:K,data:P,index:F}),I.$88l=F,I.$87l=P}else if(I.$40l){var Q=I.$6l,W={x:Q.x+Q.width/2,y:Q.y+Q.height/2},O=p(I.$23l);O.x/=r,O.y/=r;var E=fs(W,O.x-W.x,O.y-W.y,-u),l=fs(W,L.x-W.x,L.y-W.y,-u);I.$24l={x:l.x-E.x,y:l.y-E.y},I.startDragging(K),Z.beginTransaction(),I.fi({kind:"beginEditRotation",event:K,data:I._rotationNode})}else if([1,2,3,5,6,7,8,9].indexOf(I.$67l)>=0){var S=I.$67l;(7===S||8===S||9===S)&&Z.beginTransaction(),I.startDragging(K)}else if(I.$71l&&o&&I.$79l(I.$71l,L)){var R=k.toSelection();Z.beginTransaction(),R.each(function(g){Z.remove(g)}),Z.endTransaction()}B()},$11l:function(){var S=this,l=S.gv;l._editing&&(S.$13l==Z||S._shape==Z&&S._edge==Z)&&(S.$73l==Z||1!==S.$67l&&5!==S.$67l&&6!==S.$67l)||(S.$5l=1),S._68I=1},$46l:function(X){var v=this,J=v.gv,_=J.lp(X),a=[];return xp(J,function(E){var z=J.getDataUI(E);if(z){var d=z._79o();F(d,_)&&a.push(E)}}),a},$47l:function(n){var F=this,q=F.$13l,u=F.gv.dm();F.$10l?(F.fi({kind:"endEditRect",event:n,direction:F.$10l}),u.endTransaction()):F._shape&&q>=0?(F.fi({kind:"endEditPoint",event:n,data:F._shape,index:q}),u.endTransaction()):F._edge&&q>=0?(F.fi({kind:"endEditPoint",event:n,data:F._edge,index:q}),u.endTransaction()):F.$23l&&F.$40l&&(F.fi({kind:"endEditRotation",event:n}),u.endTransaction())},handleWindowTouchEnd:function(H){this.handleWindowMouseUp(H)},handleWindowMouseUp:function(V){var i=this,T=i.gv,S=T.dm(),D=i._shape,r=i._edge,_=i.$13l,Y=i.$40l,f=i.$9l,d=i.$10l,u=i.$67l;if((D||r)&&_>=0&&f>=0){var R,m;if(D){var l=D.p(),e=D.getRotation();R=D.getPoints(),m=R.get(f),Zh(D,l,e,_,m,!1)}else if(R=bc(T.getDataUI(r),r.s("edge.points"),!0),m=R.get(f),0===_){var v=R.get(0);r.s("edge.source.offset.x",m.x-v.x),r.s("edge.source.offset.y",m.y-v.y)}else if(_===R.size()-1){var C=R.get(R.size()-1);r.s("edge.target.offset.x",m.x-C.x),r.s("edge.target.offset.y",m.y-C.y)}else"points"===r.s("edge.type")&&(R.set(_,m),r.s("edge.points",Ko(R)))}i.$47l(V);var N=i.$73l;1===u?(S.beginTransaction(),N?T.sm().each(function(u){if(u.setHost&&T.isHelperEditable(u,"host")){u.setHost(N);
var O=i.$75l,k=i.$74l;O&&(u.s("attach.row.index",O.rowIndex),u.s("attach.column.index",O.columnIndex)),k&&(u.s("attach.index",k.attachIndex),u.s("attach.offset",k.attachOffset),u.s("attach.offset.relative",!1),u.s("attach.offset.opposite",!1))}}):T.sm().each(function(W){W.setHost&&T.isHelperEditable(W,"host")&&(W.setHost(Z),W.s("attach.row.index",k),W.s("attach.column.index",k),W.s("attach.index",k),W.s("attach.offset",k),W.s("attach.offset.relative",!1),W.s("attach.offset.opposite",!1))}),S.endTransaction()):2===u?(S.beginTransaction(),N?T.sm().each(function(Y){Y.setParent&&T.isHelperEditable(Y,"parent")&&Y.setParent(N)}):T.sm().each(function(p){p.setParent&&T.isHelperEditable(p,"parent")&&p.setParent(Z)}),S.endTransaction()):3===u?N&&(S.beginTransaction(),T.sm().each(function(k){if(T.isHelperEditable(k,"edge")&&k instanceof H&&N instanceof H){var G=new $.Edge;S.add(G),G.setSource(k),G.setTarget(N),i.onEdgeCreated&&i.onEdgeCreated(V,G)}}),S.endTransaction()):5===u||6===u?N&&(S.beginTransaction(),T.sm().each(function(P){P instanceof U&&N instanceof H&&(5===u&&T.isHelperEditable(P,"source")?P.setSource(N):6===u&&T.isHelperEditable(P,"source")&&P.setTarget(N))}),S.endTransaction()):(7===u||8===u||9===u)&&S.endTransaction(),(d||Y)&&i.$43l(!0),E?(i.clear(),delete i.$64l,i._68I||i.$43l()):(i.handle_mousemove(V,!0),u&&!i._68I&&i.$43l())},handleWindowTouchMove:function(E){this.handleWindowMouseMove(E)},handleWindowMouseMove:function(m){this._78I(m)},handle_mousemove:function(T,k,s){if(!this._pause){if(!s){var _=E?no(T):T;this.$61l={clientX:_.clientX,clientY:_.clientY}}if(k===!0||!P()){var c=this,w=c.gv,i=!1,t=Z;c.clear(),w.sm().size()>0&&(t=w.lp(s?c.$61l:T),i=c._79I(T,t)),i&&(w._editing=1),c.$12l!==c.$65l&&(c.$65l=c.$12l,c.setCursor(c.$12l)),c.$40l!==c.$64l&&(c.$64l=c.$40l,c._68I||c.$43l()),c._hoverSegmentIndex!==c.$66l&&(c.$66l=c._hoverSegmentIndex,c._68I||c.$43l())}}},_78I:function(O){this.autoScroll(O);var C=this,w=C.gv,K=w.lp(O),i=w.getZoom(),A=C.$13l;if((C._shape||C._edge)&&A>=0){var J,z,s,S=C._shape,j=C._edge,E=C.$24l,X=w.getPointSnapSpacing(),F=function(n,i){return X==Z||isNaN(X)?{x:n,y:i}:{x:W(n/X)*X,y:W(i/X)*X}};if(S){J=S.getPoints();var q=S.p(),l=S.getRotation(),_=0;z=fs(q,K.x-q.x,K.y-q.y,-l),Zh(S,q,l,A,K,!0,E,F),C.fi({kind:"betweenEditPoint",event:O,data:S,index:A})}else if(j){J=bc(w.getDataUI(j),j.s("edge.points"),!0),K.x-=E.x,K.y-=E.y,z=K;var e,M,$=j.s("edge.offset"),c=J.size(),B=c>2;if(0===A){var V=J.get(0);$&&(V=Fp(V,J.get(1),-$,B),K=Fp(K,J.get(1),-$,B)),e=K.x-V.x,M=K.y-V.y,s=F(e,M),j.s("edge.source.offset.x",s.x),j.s("edge.source.offset.y",s.y)}else if(A===c-1){var h=J.get(c-1);$&&(h=Fp(h,J.get(c-2),-$,B),K=Fp(K,J.get(c-2),-$,B)),e=K.x-h.x,M=K.y-h.y,s=F(e,M),j.s("edge.target.offset.x",s.x),j.s("edge.target.offset.y",s.y)}else"points"===j.s("edge.type")&&(s=F(K.x,K.y),s.e=J.get(A).e,J.set(A,s),j.s("edge.points",Ko(J)));C.fi({kind:"betweenEditPoint",event:O,data:j,index:A})}if(delete C.$9l,w.isSnapPoint(S)||w.isSnapPoint(j))for(_=0;_<J.size();_++)if(_!==A){var a=J.get(_);if(y(a,z)<w.getEditPointSize()/i){C.$9l=_;break}}}else if(C.$10l){var E=C.$24l;K.x-=E.x,K.y-=E.y;var d=w.sm().getSelection(),G=C.$1l,N=C.$7l,m=C.$10l,I=C.$4l,D=C.$2l,k=w.getEditRectPadding()/i,p=2*k,f=w.getSnapSpacing(),R=f!=Z&&!isNaN(f),b=Lm(D,K,m,N,2*k,w.getResizeMode(),R,!0),n=C.$6l;if(R){var P=b.width-p,L=b.height-p,x=W(P/f)*f,lg=W(L/f)*f,Vm=x-P,Ug=lg-L;("west"===m||"northwest"===m||"southwest"===m)&&(Vm=-Vm),("north"===m||"northwest"===m||"northeast"===m)&&(Ug=-Ug),b=Lm(D,K,m,N,2*k,w.getResizeMode(),R,!1,Vm,Ug)}C.$8l=b,n.x=b.x+k,n.y=b.y+k,n.width=b.width-p,n.height=b.height-p;var Wb=b.x+b.width/2,Gq=b.y+b.height/2,Di=n.x,Sb=n.y,fk=n.width/I.width,Mj=n.height/I.height;d.each(function(b){if(b instanceof H&&w.isEditable(b)&&w.isRectEditable(b)){var y=G[b.getId()],W=C.$3l[b.getId()],R={x:y.x+y.width/2,y:y.y+y.height/2},B=0,$=0,P=m,z=180*v(N-b.getRotation())/r;"northeast"===m?z>=315||45>z?(B=y.width*fk+y.x,$=y.height*(1-Mj)+y.y,P="northeast"):z>=45&&135>z?(B=y.width*(1-Mj)+y.x,$=y.height*(1-fk)+y.y,P="northwest"):z>=135&&225>z?(B=y.width*(1-fk)+y.x,$=y.height*Mj+y.y,P="southwest"):(B=y.width*Mj+y.x,$=y.height*fk+y.y,P="southeast"):"north"===m?z>=315||45>z?($=y.height*(1-Mj)+y.y,P="north"):z>=45&&135>z?(B=y.width*(1-Mj)+y.x,P="west"):z>=135&&225>z?($=y.height*Mj+y.y,P="south"):(B=y.width*Mj+y.x,P="east"):"northwest"===m?z>=315||45>z?(B=y.width*(1-fk)+y.x,$=y.height*(1-Mj)+y.y,P="northwest"):z>=45&&135>z?(B=y.width*(1-Mj)+y.x,$=y.height*fk+y.y,P="southwest"):z>=135&&225>z?(B=y.width*fk+y.x,$=y.height*Mj+y.y,P="southeast"):(B=y.width*Mj+y.x,$=y.height*(1-fk)+y.y,P="northeast"):"west"===m?z>=315||45>z?(B=y.width*(1-fk)+y.x,P="west"):z>=45&&135>z?($=y.height*fk+y.y,P="south"):z>=135&&225>z?(B=y.width*fk+y.x,P="east"):($=y.height*(1-fk)+y.y,P="north"):"southwest"===m?z>=315||45>z?(B=y.width*(1-fk)+y.x,$=y.height*Mj+y.y,P="southwest"):z>=45&&135>z?(B=y.width*Mj+y.x,$=y.height*fk+y.y,P="southeast"):z>=135&&225>z?(B=y.width*fk+y.x,$=y.height*(1-Mj)+y.y,P="northeast"):(B=y.width*(1-Mj)+y.x,$=y.height*(1-fk)+y.y,P="northwest"):"east"===m?z>=315||45>z?(B=y.width*fk+y.x,P="east"):z>=45&&135>z?($=y.height*(1-fk)+y.y,P="north"):z>=135&&225>z?(B=y.width*(1-fk)+y.x,P="west"):($=y.height*fk+y.y,P="south"):"south"===m?z>=315||45>z?($=y.height*Mj+y.y,P="south"):z>=45&&135>z?(B=y.width*Mj+y.x,P="east"):z>=135&&225>z?($=y.height*(1-Mj)+y.y,P="north"):(B=y.width*(1-Mj)+y.x,P="west"):"southeast"===m&&(z>=315||45>z?(B=y.width*fk+y.x,$=y.height*Mj+y.y,P="southeast"):z>=45&&135>z?(B=y.width*Mj+y.x,$=y.height*(1-fk)+y.y,P="northeast"):z>=135&&225>z?(B=y.width*(1-fk)+y.x,$=y.height*(1-Mj)+y.y,P="northwest"):(B=y.width*(1-Mj)+y.x,$=y.height*fk+y.y,P="southwest"));var M=fs(R,B-R.x,$-R.y,b.getRotation());wr(b,y,P,{x:M.x,y:M.y});var O=Di+n.width*W.x,f=Sb+n.height*W.y,q={x:O,y:f};q=fs({x:Wb,y:Gq},q.x-Wb,q.y-Gq,N),b.p(q.x,q.y)}}),C.fi({kind:"betweenEditRect",event:O,direction:m})}else if(C.$23l&&C.$40l){var Wn=C.$8l,ar=Wn.width,Zg=Wn.height,q={x:Wn.x+ar/2,y:Wn.y+Zg/2},E=C.$24l,tm=C.$23l,Vr=tm.x/i-q.x,si=tm.y/i-q.y,pg=u(Vr*Vr+si*si),ek=Math.asin(E.x/pg),gn=w.sm().getSelection(),Wf=Q+o(K.y-q.y,K.x-q.x)-ek,dj=w.getSnapAngle(),Wf=W(Wf/dj)*dj;0>Wf&&(Wf+=Y);var ps=Wf-C.$7l,uj=[q.x,0,q.y];gn.each(function(B){if(w.isEditable(B)&&w.isRotationEditable(B)&&w.isVisible(B)){var j=Cf(B.p3(),uj),t=cj();tf(t,-ps),B.setRotation(B.getRotation()+ps),mp(j,t),B.p3(uj[0]+j[0],uj[1]+j[1],uj[2]+j[2])}}),C.$7l=Wf,C.fi({kind:"betweenEditRotation",event:O})}else if([1,2,3,5,6].indexOf(C.$67l)>=0)C.$72l=O,C.$78l||(C.$78l=1,g(function(){T.isDragging()&&C.$43l(),delete C.$78l},12));else if(7===C.$67l){if(C.$87l instanceof t){var S=C.$87l,Il=C.$88l,xj=T.clone(S.getPoints().get(Il)),jk=K.y-xj.y;xj.e||(xj.e=0),C.$92l||(C.$92l=xj.e),xj.e=C.$92l-jk,S.setPoint(Il,xj)}else if(C.$87l instanceof U){var j=C.$87l,Il=C.$88l,J=bc(w.getDataUI(j),j.s("edge.points")),xj=J.get(Il),jk=K.y-xj.y;xj.e||(xj.e=0),C.$92l||(C.$92l=xj.e),xj.e=C.$92l-jk,J.set(Il,xj),j.s("edge.points",Ko(J))}}else if(8===C.$67l){var gn=w.sm().getSelection(),on=C.$93l;on||(on=C.$93l={}),gn.each(function(p){if(p.p3){var G=p.p3(),Q=on[p.getId()];Q==Z&&(Q=on[p.getId()]=G[1]),p.p3([G[0],Q-(K.y-C.$90l.y/i),G[2]])}})}else if(9===C.$67l){var gn=w.sm().getSelection(),Lf=C.$94l;Lf||(Lf=C.$94l={}),gn.each(function(B){if(B.s3){var X=B.s3(),F=Lf[B.getId()];F==Z&&(F=Lf[B.getId()]=X[1]);var N=F-(K.y-C.$91l.y/i);0>N&&(N=.01),B.s3([X[0],N,X[2]])}})}},$79l:function(k,C){var E=this,u=E.gv,Z=u.getZoom(),P=u.getEditHelperSize(),R=k.x/Z,q=k.y/Z,y=P/Z,p=y/2;return F({x:R-p,y:q-p,width:y,height:y},C)?!0:void 0},getHelperCursor:function(){return"crosshair"},_79I:function(D,N){for(var _=this,h=_.gv,R=h.getZoom(),j=h.getEditPointSize(),A=j/R,b=A/2,K=_.$46l(D),H=0;H<K.length;H++){var m,z,G=K[H],d=h.getDataUI(G);if(d&&d._55O){var c=d._55O;if(c._43O&&G instanceof U){if(m=G.s("edge.points"),m=bc(d,m),z=G.s("edge.segments"),z&&z.size()||(z=Wd(m)),_.$42l(G,N,m._as,z,"edge"))return!0;if("points"===G.s("edge.type")&&_.$41l(G,N,m._as,z,"edge"))return}if(c._43O&&G instanceof t&&c.$15l&&c.$15l.length===G.getPoints().size()){if(m=c.$15l,z=G.getSegments(),z&&z.size()||(z=Wd(m)),_.$42l(G,N,m,z,"shape"))return!0;if(_.$41l(G,N,m,z,"shape"))return}}}if(_.$16l){var m,L=_.$16l,Z=L[3].x-L[7].x,E=L[3].y-L[7].y,i=u(Z*Z+E*E),C=L[1].x-L[5].x,W=L[1].y-L[5].y,y=u(C*C+W*W),l={x:N.x*R,y:N.y*R};if(_._80I(l,0,L[0],"northwest",i,y)||_._80I(l,1,L[1],"north",i,y)||_._80I(l,2,L[2],"northeast",i,y)||_._80I(l,7,L[7],"west",i,y)||_._80I(l,3,L[3],"east",i,y)||_._80I(l,6,L[6],"southwest",i,y)||_._80I(l,5,L[5],"south",i,y)||_._80I(l,4,L[4],"southeast",i,y))return!0}if(_.$23l){var V=_.$23l,O=V.x/R,o=V.y/R;if(F({x:O-b,y:o-b,width:A,height:A},N))return _.$40l=1,_.$12l=_.getHelperCursor("rotation")||"crosshair",!0}return _.$68l&&_.$79l(_.$68l,N)?(_.$67l=1,_.$12l=_.getHelperCursor("host")||"crosshair",!0):_.$69l&&_.$79l(_.$69l,N)?(_.$67l=2,_.$12l=_.getHelperCursor("parent")||"crosshair",!0):_.$70l&&_.$79l(_.$70l,N)?(_.$67l=3,_.$12l=_.getHelperCursor("edge")||"crosshair",!0):_.$71l&&_.$79l(_.$71l,N)?(_.$67l=4,_.$12l=_.getHelperCursor("remove")||"crosshair",!0):_.$82l&&_.$79l(_.$82l,N)?(_.$67l=5,_.$12l=_.getHelperCursor("source")||"crosshair",!0):_.$83l&&_.$79l(_.$83l,N)?(_.$67l=6,_.$12l=_.getHelperCursor("target")||"crosshair",!0):_._pointElevationHelperPoint&&_.$79l(_._pointElevationHelperPoint,N)?(_.$67l=7,_.$12l=_.getHelperCursor("pointElevation")||"crosshair",!0):_.$90l&&_.$79l(_.$90l,N)?(_.$67l=8,_.$12l=_.getHelperCursor("elevation")||"crosshair",!0):_.$91l&&_.$79l(_.$91l,N)?(_.$67l=9,_.$12l=_.getHelperCursor("tall")||"crosshair",!0):!1},_80I:function(q,o,k,d,R,j){var Z=this,x=Z.gv,b=x.getEditPointSize(),g=b/2,s=x.sm(),Y=x.isDirectionEditable;if(Y&&1===s.size()){var B=s.ld();if(Y=Y.bind(x),B instanceof H){if(!Y(B,d))return!1;if("east"===d){if(Y(B,"northeast")&&Y(B,"southeast")&&2*b>=j)return!1}else if("west"===d){if(Y(B,"northwest")&&Y(B,"southwest")&&2*b>=j)return!1}else if("north"===d){if(Y(B,"northwest")&&Y(B,"northeast")&&2*b>=R)return!1}else if("south"===d&&Y(B,"southwest")&&Y(B,"southeast")&&2*b>=R)return!1}}else{if(2*b>=R&&("north"===d||"south"===d))return!1;if(2*b>=j&&("east"===d||"west"===d))return!1}if(F({x:k.x-g,y:k.y-g,width:b,height:b},q)){if(Z.$10l!==d){var D=180*Z.$7l/r,J="";D>=337.5||22.5>D?J="north":D>=22.5&&67.5>D?J="northeast":D>=67.5&&112.5>D?J="east":D>=112.5&&157.5>D?J="southeast":D>=157.5&&202.5>D?J="south":D>=202.5&&247.5>D?J="southwest":D>=247.5&&292.5>D?J="west":D>=292.5&&337.5>D&&(J="northwest");var U=Vo.indexOf(J),J=Vo[o-(1-U)+8];switch(J){case"northwest":Z.$12l="nwse-resize";break;case"northeast":Z.$12l="nesw-resize";break;case"southwest":Z.$12l="nesw-resize";break;case"southeast":Z.$12l="nwse-resize";break;case"north":Z.$12l="ns-resize";break;case"east":Z.$12l="ew-resize";break;case"south":Z.$12l="ns-resize";break;case"west":Z.$12l="ew-resize"}Z.$10l=d}return!0}return!1},$42l:function(G,J,t,w,o){var A,B=this,U=B.gv,q=U.getEditPointSize(),m=q/U.getZoom(),Z=-1,e={x:J.x,y:J.y,width:0,height:0},L=function(f){"shape"===o?B._shape=G:B._edge=G,B._removePointIndex=f},H=function(F){"shape"===o?B._shape=G:B._edge=G,B.$13l=F,B.$12l="crosshair"};for(z(e,m/2),Z=t.length-1,A=w.size()-1;A>=0;A--){var p=w.get(A);if(1===p||2===p)Z-=1;else if(3===p){var T=t[Z-1];if(F(e,T))return H(Z-1),!0;Z-=2}else if(4===p){var l=t[Z-1],b=t[Z-2];if(F(e,l))return H(Z-1),!0;if(F(e,b))return H(Z-2),!0;Z-=3}}for(Z=t.length-1,A=w.size()-1;A>=0;A--){var p=w.get(A),y=t[Z];if(F(e,y))return L(Z),H(Z),!0;1===p||2===p?Z-=1:3===p?Z-=2:4===p&&(Z-=3)}return!1},$41l:function(o,k,y,q,d){var b=this,X=b.gv,T=-1,m=0,n={x:k.x,y:k.y,width:0,height:0},O=function(Z,J){b._hoverSegmentIndex=J,b._lp=k,"shape"===d?b._shape=o:b._edge=o};for(z(n,X.getSegmentHoverWidth()/2/X.getZoom()),o instanceof t&&o.isClosePath()&&q.indexOf(5)<0&&(q=new l(q._as),q.add(5));m<q.size();m++){var K=q.get(m);if(1===K){var I=y[T],E=y[T+1];if(I){var s=Yq(new Rp(I.x,I.y),new Rp(E.x,E.y),new Rp(n.x,n.y),new Rp(n.x+n.width,n.y+n.height));if(s.$62l===x&&s.points.length>0)return O(s,m),!0}T+=1}else if(2===K){var I=y[T],E=y[T+1],s=Yq(new Rp(I.x,I.y),new Rp(E.x,E.y),new Rp(n.x,n.y),new Rp(n.x+n.width,n.y+n.height));if(s.$62l===x&&s.points.length>0)return O(s,m),!0;T+=1}else if(3===K){var I=y[T],f=y[T+1],W=y[T+2],s=Pr(new Rp(I.x,I.y),new Rp(f.x,f.y),new Rp(W.x,W.y),new Rp(n.x,n.y),new Rp(n.x+n.width,n.y+n.height));if(s.$62l===x)return O(s,m),!0;T+=2}else if(4===K){var I=y[T],N=y[T+1],Z=y[T+2],W=y[T+3],s=fk(new Rp(I.x,I.y),new Rp(N.x,N.y),new Rp(Z.x,Z.y),new Rp(W.x,W.y),new Rp(n.x,n.y),new Rp(n.x+n.width,n.y+n.height));if(s.$62l===x)return O(s,m),!0;T+=3}else if(5===K){var I=y[T],E=y[0];if(I){var s=Yq(new Rp(I.x,I.y),new Rp(E.x,E.y),new Rp(n.x,n.y),new Rp(n.x+n.width,n.y+n.height));if(s.$62l===x&&s.points.length>0)return O(s,m),!0}}}return!1},addShapePoint:function(Y,H,a){var k=this,B=k.gv,y=B.dm();if(y.beginTransaction(),0===arguments.length&&(Y=k._shape||k._edge,H=k._hoverSegmentIndex,a=k._lp),Y instanceof t||Y instanceof U){var h=$b(Y,B.getDataUI(Y),H);if(!isNaN(H)&&a&&!isNaN(h)){var S=a;if(Y instanceof t){var b=Y.p(),u=Y.getRotation(),s=Y.toSegments();s&&s.size()||(s=Wd(Y.getPoints())),Y.isClosePath()&&s.indexOf(5)<0&&(s=new l(s._as),s.add(5));var p=s.get(H),W="addPoint",f="removePointAt";if(2===p||1===p){var R={x:S.x,y:S.y};s.add(p,H),R=fs(b,R.x-b.x,R.y-b.y,-u),Y[W](R,h+1)}else if(3===p){var F=Y.getPoints(),X=F.get(h),e=F.get(h+2),R={x:S.x,y:S.y};R=fs(b,R.x-b.x,R.y-b.y,-u);var G=bd(X,R),T=bd(R,e);s.removeAt(H),s.add(3,H),s.add(3,H),Y.setPoint(h+1,R),Y[W](T,h+2),Y[W](G,h+1)}else if(4===p){var F=Y.getPoints(),X=F.get(h),e=F.get(h+3),R={x:S.x,y:S.y};R=fs(b,R.x-b.x,R.y-b.y,-u);var G=$j(X,R),T=Zb(X,R),V=$j(R,e),v=Zb(R,e);s.removeAt(H),s.add(4,H),s.add(4,H),Y[f](h+1),Y[f](h+1),Y[W](R,h+1),Y[W](v,h+2),Y[W](V,h+2),Y[W](T,h+1),Y[W](G,h+1)}else if(5===p){var R={x:S.x,y:S.y};s.add(2,H),R=fs(b,R.x-b.x,R.y-b.y,-u),Y[W](R,h+1)}Y.isClosePath()&&s.remove(5),Y.setSegments(s);var C=Y.getWidth(),q=Y.getHeight(),I=Y.p().x-C/2,D=Y.p().y-q/2;I-=b.x,D-=b.y;var N=Zp(Y,{x:I,y:D,width:C,height:q},u,b);Y.p(N.x,N.y)}else if(Y instanceof U){if("points"!==Y.s("edge.type"))return y.endTransaction(),void 0;var F=Y.s("edge.points");s=Y.s("edge.segments"),F=bc(B.getDataUI(Y),F),s&&s.size()||(s=Wd(F)),s=new l(s._as.slice(0)),F=new l(F._as.slice(0));var p=s.get(H);if(2===p||1===p){var R={x:S.x,y:S.y};s.add(p,H),F.add(R,h+1)}else if(3===p){var X=F.get(h),e=F.get(h+2),R={x:S.x,y:S.y},G=bd(X,R),T=bd(R,e);s.removeAt(H),s.add(3,H),s.add(3,H),F.set(h+1,R),F.add(T,h+2),F.add(G,h+1)}else if(4===p){var X=F.get(h),e=F.get(h+3),R={x:S.x,y:S.y},G=$j(X,R),T=Zb(X,R),V=$j(R,e),v=Zb(R,e);s.removeAt(H),s.add(4,H),s.add(4,H),F.removeAt(h+1),F.removeAt(h+1),F.add(R,h+1),F.add(v,h+2),F.add(V,h+2),F.add(T,h+1),F.add(G,h+1)}Y.s("edge.points",Ko(F)),Y.s("edge.segments",s)}}}y.endTransaction()},removeShapePoint:function(G,Q){var I=this,K="removeAt",y=I.gv,g=y.dm();if(g.beginTransaction(),0===arguments.length&&(G=I._shape||I._edge,Q=I._removePointIndex),Q>=0&&(G instanceof t||G instanceof U)){var L=Hb(G,I.gv.getDataUI(G),Q),Y=Q;if(G instanceof t){var k=G.p(),w=G.toSegments();w&&w.size()||(w=Wd(G.getPoints()));var m=w.get(L),h="removePointAt";if(1===m&&0===Y)if(G.getPoints().size()>1){var Z=w.get(L+1);w[K](L+1),3===Z?G[h](Y+1):4===Z&&(G[h](Y+2),G[h](Y+1)),G[h](Y)}else G.dm().remove(G);else 2===m||1===m?(w[K](L),G[h](Y)):3===m?(w[K](L),G[h](Y),G[h](Y-1)):4===m&&(w[K](L),G[h](Y),G[h](Y-1),G[h](Y-2));G.setSegments(w);var A=G.getWidth(),s=G.getHeight(),$=G.p().x-A/2,u=G.p().y-s/2;$-=k.x,u-=k.y;var H=Zp(G,{x:$,y:u,width:A,height:s},G.getRotation(),k);G.p(H.x,H.y)}else if(G instanceof U){if("points"!==G.s("edge.type"))return g.endTransaction(),void 0;var q=G.s("edge.points");if(w=G.s("edge.segments"),q&&(q=bc(I.gv.getDataUI(G),q),w&&w.size()||(w=Wd(q))),0===Q||Q===q.size()-1)return g.endTransaction(),void 0;w=new l(w._as.slice(0)),q=new l(q._as.slice(0));var m=w.get(L);2===m||1===m?(w[K](L),q[K](Y)):3===m?(w[K](L),q[K](Y),q[K](Y-1)):4===m&&(w[K](L),q[K](Y),q[K](Y-1),q[K](Y-2)),G.s("edge.segments",w),G.s("edge.points",Ko(q))}}g.endTransaction()},changeShapeSegment:function(N,f,r){var x=this,R=x.gv,D=R.dm();if(D.beginTransaction(),1!==arguments.length||isNaN(N)||(r=N,N=x._shape||x._edge,f=x._hoverSegmentIndex),N instanceof t||N instanceof U){var c=$b(N,x.gv.getDataUI(N),f);if(!isNaN(f)&&!isNaN(c))if(N instanceof t){var Q=N.p(),O=N.toSegments();O&&O.size()||(O=Wd(N.getPoints()));var L=O.get(f),w=N.toPoints();if(1===r||2===r)1===L||2===L?O.set(f,r):3===L?(O.set(f,r),w.removeAt(c+1)):4===L&&(O.set(f,r),w.removeAt(c+1),w.removeAt(c+1));else if(3===r){var I=function(){var D=w.get(c),U=w.get(c+1),a=bd(D,U);O.set(f,3),w.add(a,c+1)};2===L||1===L?I():4===L&&(w.removeAt(c+1),w.removeAt(c+1),I())}else if(4===r){var b=function(){var j=w.get(c),_=w.get(c+1),s=$j(j,_),e=Zb(j,_);O.set(f,4),w.add(s,c+1),w.add(e,c+2)};2===L||1===L?b():3===L&&(w.removeAt(c+1),b())}N.setSegments(O),N.setPoints(w);var K=N.getWidth(),C=N.getHeight(),Y=N.p().x-K/2,m=N.p().y-C/2;Y-=Q.x,m-=Q.y;var a=new Zp(N,{x:Y,y:m,width:K,height:C},N.getRotation(),Q);N.p(a.x,a.y)}else if(N instanceof U){if("points"!==N.s("edge.type"))return D.endTransaction(),void 0;var w=N.s("edge.points");O=N.s("edge.segments"),w&&(w=bc(x.gv.getDataUI(N),w),O&&O.size()||(O=Wd(w))),O=new l(O._as.slice(0)),w=new l(w._as.slice(0));var L=O.get(f);if(1===r||2===r)1===L||2===L?O.set(f,r):3===L?(O.set(f,r),w.removeAt(c+1)):4===L&&(O.set(f,r),w.removeAt(c+1),w.removeAt(c+1));else if(3===r){var I=function(){var X=w.get(c),Z=w.get(c+1),$=bd(X,Z);O.set(f,3),w.add($,c+1)};2===L||1===L?I():4===L&&(w.removeAt(c+1),w.removeAt(c+1),I())}else if(4===r){var b=function(){var H=w.get(c),h=w.get(c+1),T=$j(H,h),s=Zb(H,h);O.set(f,4),w.add(T,c+1),w.add(s,c+2)};2===L||1===L?b():3===L&&(w.removeAt(c+1),b())}N.s("edge.points",Ko(w)),N.s("edge.segments",O)}}D.endTransaction()},getDefaultSegments:function(n){var d=this.gv,E=d.getDataUI(n);if(n instanceof U){var l=n.s("edge.points");return l=bc(E,l),Wd(l)}if(n instanceof t){var l=n.getPoints(),B=n.getSegments();return B&&B.size()>0?B:Wd(l)}},$43l:function(a){var G=this;a&&(G.$5l=1),G._68I=1,G._42()},_42:function(){var w=this;if(w._68I){delete w._68I;var i=w.gv,x=w.$5l,L=i.getZoom(),I=i.getEditPointSize(),F=I/2,r=new l,g=w._view,V=w._edge,N=w._shape,P=g.getContext("2d"),R=i.tx(),a=i.ty(),S=Z,d=i.getEditPointBackground(),D=i.getControlPointBackground(),v=i.getControlPointBorderColor(),K=i.getEditPointBorderColor(),h=i.getEditRectBorderColor(),n=i.getDirectionLineColor(),k=i.getSegmentHoverColor(),_=i.getSnapPointBorderColor(),y=i.getJoinPointBackground(),f=i.getJoinPointBorderColor(),j=i.getSegmentHoverWidth(),s=[5,5],M=i.getEditRectBorderStyle();fb(i,function(E){i.isSelected(E)&&i.isVisible(E)&&r.add(E)}),P.clearRect(0,0,J(g.width),J(g.height)),P.save(),e.translateAndScale(P,R,a,1);var o=Z,O={x:0,y:0,width:0,height:0},A=0,q=0,W=0,E=0,Q=0,b=0,wn=0,Iq=0,Ok=0,em=0,Ze=[];if(x?(delete w.$6l,delete w.$8l,delete w.$7l,delete w.$16l,delete w.$23l):(o=w.$6l,S=w.$7l),delete w.$68l,delete w.$69l,delete w.$71l,delete w.$70l,delete w.$82l,delete w.$83l,delete w._pointElevationHelperPoint,delete w.$90l,delete w.$91l,delete w.$75l,delete w.$74l,r.each(function(N){var Z=i.getDataUI(N);if(Z){var v=Z._55O;if(i.isEditable(N))v._56O&&N instanceof H&&q++,Ze.push(N),v._42O&&N instanceof H&&A++,i.isHelperEditable(N,"host")&&E++,i.isHelperEditable(N,"parent")&&W++,i.isHelperEditable(N,"remove")&&Q++,i.isHelperEditable(N,"edge")&&b++,i.isHelperEditable(N,"source")&&wn++,i.isHelperEditable(N,"target")&&Iq++,i.isHelperEditable(N,"elevation")&&Ok++,i.isHelperEditable(N,"tall")&&em++;else if(N instanceof C&&N.isExpanded()){var D=!0,t=i.getEditableFunc();t&&(D=t(N)),D&&(i.isHelperEditable(N,"host")&&E++,i.isHelperEditable(N,"parent")&&W++,i.isHelperEditable(N,"remove")&&Q++,i.isHelperEditable(N,"edge")&&b++,i.isHelperEditable(N,"source")&&wn++,i.isHelperEditable(N,"target")&&Iq++,i.isHelperEditable(N,"elevation")&&Ok++,i.isHelperEditable(N,"tall")&&em++,Ze.push(N))}}}),P.beginPath(),P.lineWidth=1,P.strokeStyle=i.getNodeBorderColor(),Ze.forEach(function(W){var e=i.getDataUI(W),q=e._55O;if(x)if(S==Z&&(S=W instanceof U?0:W instanceof C&&W.isExpanded()?0:W.getRotation(),w.$7l=S),o==Z){var F,r,u;if(W instanceof C&&W.isExpanded()||W instanceof U){var v=i.getDataUIBounds(W);r=v.width,u=v.height,F={x:v.x+r/2,y:v.y+u/2}}else F=W.p(),r=W.getWidth(),u=W.getHeight();o={x:F.x,y:F.y,width:0,height:0},O.x=F.x-r/2,O.y=F.y-u/2,O.width=r,O.height=u,o=c(o,O)}else{var F,r,u,z,$=o.x+o.width/2,k=o.y+o.height/2,h={x:$,y:k};if(W instanceof C&&W.isExpanded()||W instanceof U){z=0;var v=i.getDataUIBounds(W);r=v.width,u=v.height,F={x:v.x+r/2,y:v.y+u/2}}else F=W.p(),r=W.getWidth(),u=W.getHeight(),z=W.getRotation();var Y={x:F.x-r/2,y:F.y-u/2,width:r,height:u},I={x:Y.x,y:Y.y},g={x:Y.x+Y.width,y:Y.y},f={x:Y.x,y:Y.y+Y.height},p={x:Y.x+Y.width,y:Y.y+Y.height},I=fs(F,I.x-F.x,I.y-F.y,z),f=fs(F,f.x-F.x,f.y-F.y,z),p=fs(F,p.x-F.x,p.y-F.y,z),g=fs(F,g.x-F.x,g.y-F.y,z),X=-S,Q=fs(h,I.x-h.x,I.y-h.y,X),d=fs(h,g.x-h.x,g.y-h.y,X),s=fs(h,f.x-h.x,f.y-h.y,X),T=fs(h,p.x-h.x,p.y-h.y,X),R=m([Q,d,s,T]);o=c(o,R),o.x-=$,o.y-=k;var K=Zp(Z,o,S,h);o.x=K.x-o.width/2,o.y=K.y-o.height/2}if(A>1&&i.isEditable(W)&&i.isRectEditable(W)&&W instanceof H){var l=W.getRect(),J=q.$45l,b=Ki(J[0],L),M=Ki(J[2],L),t=Ki(J[4],L),n=Ki(J[6],L);W.getRotation()?(P.moveTo(b.x,b.y),P.lineTo(M.x,M.y),P.lineTo(t.x,t.y),P.lineTo(n.x,n.y),P.lineTo(b.x,b.y)):P.rect(l.x*L,l.y*L,l.width*L,l.height*L)}}),P.stroke(),o){w.$6l=p(o),z(o,i.getEditRectPadding()/L);var Eh={x:o.x+o.width/2,y:o.y+o.height/2},Cd=vo(Eh,o.width,o.height,S),Wg=Cd[0],_m=Cd[1],qj=Cd[2],Hp=Cd[3],mq=Cd[4],Hi=Cd[5],Cm=Cd[6],ws=Cd[7];if(Wg=Ki(Cd[0],L),_m=Ki(Cd[1],L),qj=Ki(Cd[2],L),Hp=Ki(Cd[3],L),mq=Ki(Cd[4],L),Hi=Ki(Cd[5],L),Cm=Ki(Cd[6],L),ws=Ki(Cd[7],L),w.$8l=o,A>0&&(w.$16l=[Wg,mq,_m,Hi,Hp,Cm,qj,ws],P.beginPath(),P.lineWidth=1,P.strokeStyle=h,"dashed"===M&&P.setLineDash&&P.setLineDash(s),P.moveTo(Wg.x,Wg.y),P.lineTo(_m.x,_m.y),P.lineTo(Hp.x,Hp.y),P.lineTo(qj.x,qj.y),P.lineTo(Wg.x,Wg.y),P.stroke(),"dashed"===M&&P.setLineDash&&P.setLineDash([])),P.beginPath(),P.lineWidth=1,P.fillStyle=d,P.strokeStyle=K,A>0){var Qm=Hi.x-ws.x,Ag=Hi.y-ws.y,Tg=u(Qm*Qm+Ag*Ag),Ym=mq.x-Cm.x,jb=mq.y-Cm.y,ng=u(Ym*Ym+jb*jb),Xg=2*I;if(i.isDirectionEditable&&1===Ze.length){var Uj=Ze[0],qe=i.getDataUI(Uj),tn=qe._55O,Pr=i.isDirectionEditable.bind(i);if(tn._42O){var Ho,rk,Zf,mg;Pr(Uj,"northwest")&&(Ho=!0,P.rect(Wg.x-F,Wg.y-F,I,I)),Pr(Uj,"northeast")&&(rk=!0,P.rect(_m.x-F,_m.y-F,I,I)),Pr(Uj,"southwest")&&(Zf=!0,P.rect(qj.x-F,qj.y-F,I,I)),Pr(Uj,"southeast")&&(mg=!0,P.rect(Hp.x-F,Hp.y-F,I,I)),Pr(Uj,"north")&&(Ho&&rk?Tg>Xg&&P.rect(mq.x-F,mq.y-F,I,I):P.rect(mq.x-F,mq.y-F,I,I)),Pr(Uj,"south")&&(mg&&Zf?Tg>Xg&&P.rect(Cm.x-F,Cm.y-F,I,I):P.rect(Cm.x-F,Cm.y-F,I,I)),Pr(Uj,"west")&&(Zf&&Ho?ng>Xg&&P.rect(ws.x-F,ws.y-F,I,I):P.rect(ws.x-F,ws.y-F,I,I)),Pr(Uj,"east")&&(mg&&rk?ng>Xg&&P.rect(Hi.x-F,Hi.y-F,I,I):P.rect(Hi.x-F,Hi.y-F,I,I))}}else Tg>Xg&&(P.rect(mq.x-F,mq.y-F,I,I),P.rect(Cm.x-F,Cm.y-F,I,I)),ng>Xg&&(P.rect(Hi.x-F,Hi.y-F,I,I),P.rect(ws.x-F,ws.y-F,I,I)),P.rect(Wg.x-F,Wg.y-F,I,I),P.rect(_m.x-F,_m.y-F,I,I),P.rect(qj.x-F,qj.y-F,I,I),P.rect(Hp.x-F,Hp.y-F,I,I)}if(q>0){var Qi=w.$23l=fs(mq,0,2*-I,S);P.moveTo(Qi.x+F,Qi.y),P.arc(Qi.x,Qi.y,F,0,Y,!1)}P.fill(),P.stroke(),w.$40l&&w.$44l(P,o,S);var Ed,Nl,wb=i.getLeftTopHelpers(),rc=i.getRightTopHelpers(),Ch=i.getLeftBottomHelpers(),Qq=i.getRightBottomHelpers(),jn=i.getEdgeHelpers(),Ld=i.getEditHelperSize(),bj=Ld/2,Eg=function(d,Z,u,q){"leftTop"===Z?(Ed=o.x*L-Ld-F-("h"===q?u*(Ld+F):0)-1,Nl=o.y*L-Ld-F-("v"===q?u*(Ld+F):0)-1):"rightTop"===Z?(Ed=(o.x+o.width)*L+F+("h"===q?u*(Ld+F):0)+1,Nl=o.y*L-Ld-F-("v"===q?u*(Ld+F):0)-1):"leftBottom"===Z?(Ed=o.x*L-Ld-F-("h"===q?u*(Ld+F):0)-1,Nl=(o.y+o.height)*L+F+("v"===q?u*(Ld+F):0)+1):"rightBottom"===Z&&(Ed=(o.x+o.width)*L+F+("h"===q?u*(Ld+F):0)+1,Nl=(o.y+o.height)*L+F+("v"===q?u*(Ld+F):0)+1);var n=Ed+bj,R=Nl+bj,m=(o.x+o.width/2)*L,I=(o.y+o.height/2)*L,g=fs({x:m,y:I},n-m,R-I,S);if("host"===d){if(E>0)return w.$77l(P,S,g),!0}else if("edge"===d){if(b>0)return w.$80l(P,S,g),!0}else if("remove"===d){if(Q>0)return Ze&&1===Ze.length&&Ze[0]instanceof U?w.$81l(P,S,{x:m+Ld/2+5,y:I}):w.$81l(P,S,g),!0}else if("parent"===d){if(W>0)return Ze&&1===Ze.length&&Ze[0]instanceof U?w.$76l(P,S,{x:m-Ld/2-5,y:I}):w.$76l(P,S,g),!0}else if("elevation"===d){if(Ok>0)return w.$85l(P,S,g),!0}else if("tall"===d){if(em>0)return w.$86l(P,S,g),!0}else if("source"===d||"target"===d){var J=Ze[0],D=i.getDataUI(J),s=dm(D,!0),B=s[0],X=s[1];if(wn&&"source"===d)return w.$84l(P,o,B,!0,J.isLooped(),Z,u,q),!0;if(Iq&&"target"===d)return w.$84l(P,o,X,!1,J.isLooped(),Z,u,q),!0}};if(wb&&wb.length>0){var If=0;wb.forEach(function(R){Eg(R,"leftTop",If,i.getLeftTopHelpersAlign()||"h")&&If++})}if(rc&&rc.length>0){var If=0;rc.forEach(function(W){Eg(W,"rightTop",If,i.getRightTopHelpersAlign()||"h")&&If++})}if(Ch&&Ch.length>0){var If=0;Ch.forEach(function(q){Eg(q,"leftBottom",If,i.getLeftBottomHelpersAlign()||"h")&&If++})}if(Qq&&Qq.length>0){var If=0;Qq.forEach(function(K){Eg(K,"rightBottom",If,i.getRightBottomHelpersAlign()||"h")&&If++})}if(jn&&jn.length>0&&((wn||Iq)&&Ze&&1===Ze.length&&Ze[0]instanceof U?!0:!1)){var If=0;jn.forEach(function(r){Eg(r,"edge",If,"h")&&If++})}if(w.$72l){var we,vq=w.$67l,cd=w.$68l,wh=w.$69l,jd=(w.$71l,w.$70l),$h=w.$82l,zf=w.$83l;if(1===vq?we=cd:2===vq?we=wh:3===vq?we=jd:5===vq?we=$h:6===vq&&(we=zf),we){var Xm=i.lp(w.$72l),pp=i.getDataAt(w.$72l);if(pp&&pp instanceof H){var Gl,Xf,Sf;if(w.$73l=pp,1===vq)if(pp instanceof $.Grid)Gl=w.$75l=nj(pp,Xm);else if(pp instanceof $.Shape){Sf=w.$74l=ah(pp,Xm);var vi=pp.getPoints();if(Sf){var Un=Sf.attachIndex,Kg=$b(pp,i.getDataUI(pp),Un)+1,Qb=Kg+1>=vi.size()?0:Kg+1,Li=vi.get(Kg),ve=vi.get(Qb),Ll=pp.p(),hp=pp.getRotation();Li=fs(Ll,Li.x-Ll.x,Li.y-Ll.y,hp),ve=fs(Ll,ve.x-Ll.x,ve.y-Ll.y,hp),P.beginPath(),P.strokeStyle=k,P.lineWidth=j,P.moveTo(Li.x*L,Li.y*L),P.lineTo(ve.x*L,ve.y*L),P.stroke()}}Gl?Xf=Gl.rect:(Xf=T.clone(i.getDataUIBounds(pp)),T.grow(Xf,2)),P.beginPath(),P.rect(Xf.x*L,Xf.y*L,Xf.width*L,Xf.height*L),P.strokeStyle=1===vq||4===vq||6===vq?G:X,P.lineWidth=2,P.setLineDash&&P.setLineDash([8,8]),P.stroke()}else delete w.$73l;Xm.x=Xm.x*L,Xm.y=Xm.y*L;var tk=kp(we.x,we.y,Xm.x,Xm.y),Wc=fs(we,Xm.x-we.x,Xm.y-we.y,-tk),Yp=Wc.x-we.x;P.save(),P.translate(we.x,we.y),P.rotate(tk),B.width=Yp,B.height=40;var tj=X;(1===vq||4===vq||6===vq)&&(tj=G),B.comps[0].gradientColor=tj,T.drawImage(P,B,0,-20,Yp,40),P.restore()}}}if(r.each(function(h){var O=i.getDataUI(h);if(O){var U,d,Q=O._55O,K=O._78o;if(Q&&Q._43O&&h instanceof t?(U=Q.$15l,d=h.getSegments(),d&&d.size()||(d=Wd(U)),h.isClosePath()&&d.indexOf(5)<0&&(d=new l(d._as),d.add(5))):Q&&K&&Q._43O&&(U=h.s("edge.points"),d=h.s("edge.segments"),U=bc(O,U),d&&d.size()||(d=Wd(U)),U&&(U=U._as)),U&&d){var u=0,E=d.size(),S=w._hoverSegmentIndex;U=U.slice(0);for(var p=0;p<U.length;p++)U[p]=Ki(U[p],L);P.beginPath(),P.strokeStyle=n,P.lineWidth=1,u=0;for(var p=0;E>p;p++){var q=d.get(p);if(1===q||2===q)u++;else if(3===q){var J=U[u-1],A=U[u],e=U[u+1];P.moveTo(J.x,J.y),P.lineTo(A.x,A.y),P.lineTo(e.x,e.y),u+=2}else if(4===q){var J=U[u-1],x=U[u],C=U[u+1],e=U[u+2];P.moveTo(J.x,J.y),P.lineTo(x.x,x.y),P.moveTo(C.x,C.y),P.lineTo(e.x,e.y),u+=3}}if(P.stroke(),N===h||V===h&&"points"===V.s("edge.type")){P.beginPath(),u=0,P.strokeStyle=k,P.lineWidth=j;for(var p=0;E>p;p++){var q=d.get(p);if(1===q||2===q){if(S===p){var J=U[u-1],e=U[u];P.moveTo(J.x,J.y),P.lineTo(e.x,e.y);break}u++}else if(3===q){if(S===p){var J=U[u-1],A=U[u],e=U[u+1];P.moveTo(J.x,J.y),P.quadraticCurveTo(A.x,A.y,e.x,e.y);break}u+=2}else if(4===q){if(S===p){var J=U[u-1],x=U[u],C=U[u+1],e=U[u+2];P.moveTo(J.x,J.y),P.bezierCurveTo(x.x,x.y,C.x,C.y,e.x,e.y);break}u+=3}else if(5===q&&S===p){var J=U[u-1],e=U[0];P.moveTo(J.x,J.y),P.lineTo(e.x,e.y);break}}P.stroke()}P.beginPath(),u=0,P.strokeStyle=f,P.lineWidth=1,P.fillStyle=y;for(var p=0;E>p;p++){var q=d.get(p);if(1===q||2===q){var e=U[u];P.moveTo(e.x+F,e.y),P.arc(e.x,e.y,F,0,Y,!0),u++}else if(3===q){var e=U[u+1];P.moveTo(e.x+F,e.y),P.arc(e.x,e.y,F,0,Y,!0),u+=2}else if(4===q){var e=U[u+2];P.moveTo(e.x+F,e.y),P.arc(e.x,e.y,F,0,Y,!0),u+=3}}P.fill(),P.stroke(),P.beginPath(),u=0,P.strokeStyle=v,P.lineWidth=1,P.fillStyle=D;for(var p=0;E>p;p++){var q=d.get(p);if(1===q||2===q)u++;else if(3===q){var A=U[u];P.moveTo(A.x+F,A.y),P.arc(A.x,A.y,F,0,Y,!0),u+=2}else if(4===q){var x=U[u],C=U[u+1];P.moveTo(x.x+F,x.y),P.arc(x.x,x.y,F,0,Y,!0),P.moveTo(C.x+F,C.y),P.arc(C.x,C.y,F,0,Y,!0),u+=3}}if(P.fill(),P.stroke(),P.beginPath(),u=0,P.strokeStyle=_,P.lineWidth=2,(N===h||V===h)&&w.$9l!=Z){var e=U[w.$9l];P.moveTo(e.x+F,e.y),P.arc(e.x,e.y,F,0,Y,!0),P.stroke()}}}}),w.$87l&&i.sm().contains(w.$87l)){var Mk,so=w.$87l,nn=w.$88l,Ld=i.getEditHelperSize(),bj=Ld/2;if(i.isHelperEditable(so,"pointElevation"))if(so instanceof t){var fr=so.getPosition();Mk=T.clone(so.getPoints().get(nn)),Mk=fs({x:fr.x,y:fr.y},Mk.x-fr.x,Mk.y-fr.y,so.getRotation()),Mk.x*=L,Mk.y*=L,P.translate(Mk.x,Mk.y),T.drawImage(P,T.getImage("xeditinteractor_elevationIcon"),bj,-bj,Ld,Ld),P.translate(-Mk.x,-Mk.y),w._pointElevationHelperPoint={x:Mk.x+Ld,y:Mk.y}}else if(so instanceof U){var As=bc(i.getDataUI(so),so.s("edge.points")),Mk=T.clone(As.get(nn));Mk.x*=L,Mk.y*=L,P.translate(Mk.x,Mk.y),T.drawImage(P,T.getImage("xeditinteractor_elevationIcon"),bj,-bj,Ld,Ld),P.translate(-Mk.x,-Mk.y),w._pointElevationHelperPoint={x:Mk.x+Ld,y:Mk.y}}}P.restore(),w.$5l=0}},$89l:function(M,y,e,v){M.save();var V=this,F=V.gv,X=F.getEditHelperSize(),u=X/2;M.beginPath(),M.translate(e.x,e.y),M.rotate(y),T.drawImage(M,v,-u,-u,X,X),M.restore()},$85l:function(N,e,D){var W=this;W.$90l=D,W.$89l(N,e,D,T.getImage("xeditinteractor_elevationIcon"))},$86l:function(h,z,X){var Z=this;Z.$91l=X,Z.$89l(h,z,X,T.getImage("xeditinteractor_tallIcon"))},$77l:function(r,k,y){var f=this;f.$68l=y,f.$89l(r,k,y,T.getImage("xeditinteractor_hostIcon"))},$80l:function(V,G,m){var p=this;p.$70l=m,p.$89l(V,G,m,T.getImage("xeditinteractor_edgeIcon"))},$81l:function(M,V,w){var D=this;D.$71l=w,D.$89l(M,V,w,T.getImage("xeditinteractor_removeIcon"))},$76l:function(z,Q,k){var $=this;$.$69l=k,$.$89l(z,Q,k,T.getImage("xeditinteractor_parentIcon"))},$84l:function(g,p,G,b,c){var l,P=this,W=P.gv,y=W.getZoom(),U=W.getEditHelperSize(),m=U/2;G.x*=y,G.y*=y,c&&(b?G.x-=m+5:G.x+=m+5),G.y-=U-2,b?(P.$82l=G,l=T.getImage("xeditinteractor_sourceIcon")):(P.$83l=G,l=T.getImage("xeditinteractor_targetIcon")),g.beginPath(),g.translate(G.x,G.y),T.drawImage(g,l,-m,-m,U,U),g.translate(-G.x,-G.y)},$44l:function(q,f,E){q.save();var $=this.gv.getZoom(),A=u(S(f.width,2)+S(f.height,2))/2*$+10,b=A,l=b+8,w=b+18,_=E,k=f.x+f.width/2,C=f.y+f.height/2;q.translate(k*$,C*$),q.beginPath(),q.strokeStyle="rgb(150, 150, 150)";for(var p=0,n=0,s=0,U=0,z=0,D=0;360>D;D++)p=D*r/180,0===D%5&&(n=a(p)*b,s=j(p)*b,U=a(p)*l,z=j(p)*l,q.moveTo(n,s),q.lineTo(U,z)),0===D%45&&(n=a(p)*b,s=j(p)*b,U=a(p)*w,z=j(p)*w,q.moveTo(n,s),q.lineTo(U,z));q.stroke(),q.beginPath(),q.rotate(-Q),q.beginPath(),q.fillStyle="rgba(255, 0, 0, 0.1)",q.strokeStyle="rgb(157, 157, 157)",q.moveTo(0,0),q.arc(0,0,w,0,E,!1),q.fill(),q.beginPath(),q.moveTo(0+w,0),q.arc(0,0,w,0,E,!1),q.stroke(),q.rotate(Q),q.font="bold 12px Verdana, Arial";var G=20*j(_),t=20*a(_),X=W(180*_/r)+"°";q.textAlign="center",q.textBaseline="middle",q.beginPath();var i=q.measureText("365.°").width;q.fillStyle="white",q.rect(G-i/2,-t-10,i,20),q.fill(),q.beginPath(),q.fillStyle="rgb(79,79,79)",q.fillText(X,G,-t),q.restore()}})}("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:(0,eval)("this"),Object);